import{X as w,j as t,H as te,F as se,v as ae,cz as re,r as N,$ as V,f as A,L as C}from"./index-3ec7abe5.js";import{I as oe}from"./inputtext.esm-e49a03d7.js";import{u as z,z as ne,F as le}from"./validationSchemas-9cdf4188.js";import{r as ie,L as ce,f as ue,v as de}from"./api-94015866.js";import{C as M}from"./index-3d6f48ca.js";import{L}from"./index-37ade0e2.js";import{P as q}from"./password.esm-ecc90f83.js";import{F as H,a as $}from"./index.esm-a84e9864.js";import"./iconBase-2780a5a8.js";var K=function(r){return typeof r=="object"&&r!==null},fe=function(r){var m=r.value,p=m===void 0?"":m,h=r.numInputs,c=h===void 0?4:h,x=r.onChange,S=r.onPaste,b=r.renderInput,I=r.shouldAutoFocus,l=I===void 0?!1:I,P=r.inputType,j=P===void 0?"text":P,_=r.renderSeparator,o=r.placeholder,a=r.containerStyle,n=r.inputStyle,y=r.skipDefaultStyles,U=y===void 0?!1:y,B=w.useState(0),d=B[0],E=B[1],v=w.useRef([]),F=function(){return p?p.toString().split(""):[]},R=j==="number"||j==="tel";w.useEffect(function(){v.current=v.current.slice(0,c)},[c]),w.useEffect(function(){var e;l&&((e=v.current[0])===null||e===void 0||e.focus())},[l]);var Q=function(){if(typeof o=="string"){if(o.length===c)return o;o.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},T=function(e){var s=R?!isNaN(Number(e)):typeof e=="string";return s&&e.trim().length===1},X=function(e){var s=e.target.value;T(s)&&(O(s),g(d+1))},G=function(e){var s=e.nativeEvent,i=e.target.value;if(!T(i)){if(i.length===c){var u=i.split("").some(function(f){return!T(f)});u||(D(i.split("")),g(c-1))}s.data===null&&s.inputType==="deleteContentBackward"&&(e.preventDefault(),O(""),g(d-1)),e.target.value=""}},J=function(e){return function(s){E(s),e.target.select()}},W=function(){E(d-1)},Y=function(e){var s=F();[e.code,e.key].includes("Backspace")?(e.preventDefault(),O(""),g(d-1)):e.code==="Delete"?(e.preventDefault(),O("")):e.code==="ArrowLeft"?(e.preventDefault(),g(d-1)):e.code==="ArrowRight"||e.key===s[d]?(e.preventDefault(),g(d+1)):(e.code==="Spacebar"||e.code==="Space"||e.code==="ArrowUp"||e.code==="ArrowDown")&&e.preventDefault()},g=function(e){var s,i,u=Math.max(Math.min(c-1,e),0);v.current[u]&&((s=v.current[u])===null||s===void 0||s.focus(),(i=v.current[u])===null||i===void 0||i.select(),E(u))},O=function(e){var s=F();s[d]=e[0],D(s)},D=function(e){var s=e.join("");x(s)},Z=function(e){var s;e.preventDefault();var i=F(),u=d,f=e.clipboardData.getData("text/plain").slice(0,c-d).split("");if(!(R&&f.some(function(ee){return isNaN(Number(ee))}))){for(var k=0;k<c;++k)k>=d&&f.length>0&&(i[k]=(s=f.shift())!==null&&s!==void 0?s:"",u++);g(u),D(i)}};return w.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},K(a)&&a),className:typeof a=="string"?a:void 0,onPaste:S},Array.from({length:c},function(e,s){return s}).map(function(e){var s,i,u;return w.createElement(w.Fragment,{key:e},b({value:(s=F()[e])!==null&&s!==void 0?s:"",placeholder:(u=(i=Q())===null||i===void 0?void 0:i[e])!==null&&u!==void 0?u:void 0,ref:function(f){return v.current[e]=f},onChange:X,onFocus:function(f){return J(f)(e)},onBlur:W,onKeyDown:Y,onPaste:Z,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(U?{}:{width:"1em",textAlign:"center"},K(n)?n:{}),className:typeof n=="string"?n:void 0,type:j,inputMode:R?"numeric":"text",onInput:G},e),e<c-1&&(typeof _=="function"?_(e):_))}))};const me=({otp:r,handleOtpChange:m})=>t.jsx(fe,{containerStyle:"flex w-1/2 justify-center self-center",inputStyle:"!w-[50px] !h-[50px] text-center focus-visible:outline-[#37b3e0] font-sm rounded-full mx-[0.5rem] p-3 shadow-2 appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",value:r,onChange:m,numInputs:6,renderInput:p=>t.jsx("input",{...p}),inputType:"number"}),_e=()=>{const r=te(),m=se(),p=ae(re),[h,c]=N.useState(0),[x,S]=N.useState(!1),[b,I]=N.useState(""),l=z({initialValues:{employee_official_email:""},validationSchema:le,onSubmit:async a=>{const n=await ue(a);n.status===200&&(V.success(n.message),c(3e4),S(!0))}}),P=a=>{const n=Math.floor(a/6e4),y=Math.floor(a%(60*1e3)/1e3);return`${n<10?"0"+n:n}:${y<10?"0"+y:y}`},j=()=>{l.handleSubmit()},_=async()=>{const a=await de({employee_official_email:l.values.employee_official_email,otp:b});a.status===200&&(V.success(a.message),S(!1),m("/reset-password"))},o=z({initialValues:{otp:b,employee_official_email:l.values.employee_official_email,password:"",confirm_password:""},validationSchema:ne,onSubmit:async a=>{delete a.confirm_password;const n=await ie(a);n.status===200&&(V.success(n.message),m("/sign-in"))},enableReinitialize:!0});return N.useEffect(()=>{let a;return x&&h!=0&&(a=setInterval(()=>{c(n=>n===0?(clearInterval(a),0):n-1e3)},1e3)),()=>clearInterval(a)},[x,h]),N.useEffect(()=>{r.pathname==="reset-password"&&!l.values.employee_official_email&&m("/forgot-password")},[l.values]),t.jsxs("div",{className:"mx-auto flex h-screen w-screen flex-col gap-2 bg-slate-100 md:flex-row md:p-2",children:[t.jsxs("div",{className:"hidden w-full flex-col bg-[#37B3E0] py-4 md:flex md:h-full md:rounded-lg",children:[t.jsx("h1",{className:"hidden text-center text-white md:block",children:"HRMS"}),t.jsx("img",{className:"m-auto",width:"90%",src:ce,alt:"Cover Image"})]}),t.jsxs("div",{className:"flex h-full w-full flex-col justify-center p-3",children:[t.jsx("h3",{className:"mb-8 text-center text-gray-900 md:hidden",children:"HRMS"}),r.pathname==="/forgot-password"&&!x&&t.jsxs("form",{id:"forgot-password-form",className:"flex w-full flex-col gap-4 p-2 md:p-4",onSubmit:l.handleSubmit,children:[t.jsx("h3",{className:"mb-4 text-gray-900",children:"Forgot Password"}),t.jsx(L,{htmlFor:"employee_official_email",required:!0,title:"E-mail",showError:l.errors.employee_official_email&&l.touched.employee_official_email,errorMessages:l.errors.employee_official_email,children:t.jsx(oe,{name:"employee_official_email",placeholder:"Enter your E-mail",value:l.values.employee_official_email,className:A("w-full",{"p-invalid text-red-500":l.errors.employee_official_email&&l.touched.employee_official_email}),onChange:a=>l.setFieldValue("employee_official_email",a.target.value)})}),t.jsxs("div",{className:"mt-4 flex w-full flex-col items-start justify-between gap-4 sm:items-center md:flex-row",children:[t.jsx(C,{className:"mb-2 cursor-pointer font-medium text-gray-600 no-underline hover:underline md:mb-0",to:"/sign-in",children:"Back to login"}),t.jsx(M,{disabled:p,className:"w-full md:w-4",raised:!0,label:"Request OTP"})]})]}),r.pathname==="/forgot-password"&&x&&t.jsxs("div",{className:"flex w-full flex-col gap-4 p-2 md:p-4",children:[t.jsx("h3",{className:"mb-4 text-gray-900",children:"Verify OTP"}),t.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[t.jsx(me,{otp:b,handleOtpChange:I}),h===0&&t.jsx(C,{className:"cursor-pointer font-medium text-[#37b3e0] no-underline hover:underline md:mb-0",to:"#",onClick:j,children:"Resend OTP"}),h!=0&&t.jsxs("p",{className:"text-center",children:[t.jsx("span",{children:"Otp expires in "}),t.jsx("span",{className:"font-bold text-[#37b3e0]",children:P(h)})]})]}),t.jsxs("div",{className:"mt-4 flex w-full flex-col items-start justify-between gap-4 sm:items-center md:flex-row",children:[t.jsx(C,{className:"mb-2 cursor-pointer font-medium text-gray-600 no-underline hover:underline md:mb-0",to:"/sign-in",children:"Back to login"}),t.jsx(M,{disabled:p,className:"w-full md:w-4",raised:!0,label:"Verify",onClick:_})]})]}),r.pathname==="/reset-password"&&t.jsxs("form",{id:"reset-password-form",className:"flex w-full flex-col gap-4 p-2 md:p-4",onSubmit:o.handleSubmit,children:[t.jsx("h3",{className:"mb-4 text-gray-900",children:"Reset Password"}),t.jsx(L,{htmlFor:"password",required:!0,title:"Password",showError:o.errors.password&&o.touched.password,errorMessages:o.errors.password,children:t.jsx(q,{inputId:"password",placeholder:"Enter your password",hideIcon:t.jsx(H,{size:20}),showIcon:t.jsx($,{size:20}),feedback:!1,toggleMask:!0,className:A("w-full",{"p-invalid text-red-500":o.errors.password&&o.touched.password}),value:o.values.password,onChange:a=>{o.setFieldValue("password",a.target.value)}})}),t.jsx(L,{htmlFor:"confirm_password",required:!0,title:"Confirm Password",showError:o.errors.confirm_password&&o.touched.confirm_password,errorMessages:o.errors.confirm_password,children:t.jsx(q,{inputId:"confirm_password",placeholder:"Type your password again",hideIcon:t.jsx(H,{size:20}),showIcon:t.jsx($,{size:20}),feedback:!1,toggleMask:!0,className:A("w-full",{"p-invalid text-red-500":o.errors.confirm_password&&o.touched.confirm_password}),value:o.values.confirm_password,onChange:a=>{o.setFieldValue("confirm_password",a.target.value)}})}),t.jsxs("div",{className:"mt-4 flex w-full flex-col items-start justify-between gap-4 sm:items-center md:flex-row",children:[t.jsx(C,{className:"mb-2 cursor-pointer font-medium text-gray-600 no-underline hover:underline md:mb-0",to:"/sign-in",children:"Back to login"}),t.jsx(M,{disabled:p,className:"w-full md:w-4",raised:!0,label:"Update"})]})]})]})]})};export{_e as default};
