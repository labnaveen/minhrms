import{C as Se,r as u,u as Ce,P as Ee,a as Oe,O as E,D as P,c as Ie,f as S,T as Pe,I as Ae,v as F,aX as Z,$ as z,aY as H,j as r,aZ as me,a_ as A,B as ie,af as Fe}from"./index-3ec7abe5.js";import{C as re}from"./dropdown.esm-1ad10373.js";import{T as se}from"./index-b2a6305f.js";import{A as ae}from"./arrow-back-2554853d.js";import{E as oe}from"./edit-c01b3e15.js";import{E as X}from"./eye-open-81f9d166.js";import{P as le}from"./plus-b36a0702.js";import{T as ce}from"./trash-4a28e917.js";import{C as O}from"./index-3d6f48ca.js";import{u as fe,D as Ue,d as Re}from"./validationSchemas-9cdf4188.js";import{K as ue,I as K}from"./inputtext.esm-e49a03d7.js";import{T as Te,B as he}from"./index-36dd5a0c.js";import{L as V}from"./index-37ade0e2.js";import{a as Be,u as Le,f as Me,b as He,c as Ke,d as Ve,e as We,g as $e,r as Ge,h as Ye}from"./api-9d9fddec.js";import{u as ee}from"./useDispatch-1aeda00f.js";import qe from"./employeeList-5a6bd7c5.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./calendar.esm-f987a87a.js";import"./index.esm-be3d6ae7.js";import"./multiselect.esm-15dd71d0.js";import"./profileComponent-6607eb16.js";import"./index-c74eb1f3.js";import"./assignUnassignAsset-c41d0081.js";import"./default_profile_image-c791ba54.js";import"./inputswitch.esm-65362ee3.js";function J(){return J=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},J.apply(this,arguments)}function U(t){"@babel/helpers - typeof";return U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},U(t)}function Xe(t,n){if(U(t)!=="object"||t===null)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var o=i.call(t,n||"default");if(U(o)!=="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function Je(t){var n=Xe(t,"string");return U(n)==="symbol"?n:String(n)}function Qe(t,n,i){return n=Je(n),n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function Q(t,n){(n==null||n>t.length)&&(n=t.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=t[i];return o}function Ze(t){if(Array.isArray(t))return Q(t)}function ze(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ve(t,n){if(t){if(typeof t=="string")return Q(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);if(i==="Object"&&t.constructor&&(i=t.constructor.name),i==="Map"||i==="Set")return Array.from(t);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Q(t,n)}}function et(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L(t){return Ze(t)||ze(t)||ve(t)||et()}function tt(t){if(Array.isArray(t))return t}function nt(t,n){var i=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(i!=null){var o,e,h,g,b=[],c=!0,p=!1;try{if(h=(i=i.call(t)).next,n===0){if(Object(i)!==i)return;c=!1}else for(;!(c=(o=h.call(i)).done)&&(b.push(o.value),b.length!==n);c=!0);}catch(y){p=!0,e=y}finally{try{if(!c&&i.return!=null&&(g=i.return(),Object(g)!==g))return}finally{if(p)throw e}}return b}}function it(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rt(t,n){return tt(t)||nt(t,n)||ve(t,n)||it()}var st=`
@layer primereact {
    .p-chips {
        display: inline-flex;
    }
    
    .p-chips-multiple-container {
        margin: 0;
        padding: 0;
        list-style-type: none;
        cursor: text;
        overflow: hidden;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .p-chips-token {
        cursor: default;
        display: inline-flex;
        align-items: center;
        flex: 0 0 auto;
    }
    
    .p-chips-input-token {
        flex: 1 1 auto;
        display: inline-flex;
    }
    
    .p-chips-token-icon {
        cursor: pointer;
    }
    
    .p-chips-input-token input {
        border: 0 none;
        outline: 0 none;
        background-color: transparent;
        margin: 0;
        padding: 0;
        box-shadow: none;
        border-radius: 0;
        width: 100%;
    }
    
    .p-fluid .p-chips {
        display: flex;
    }
    
    .p-chips-icon-left,
    .p-chips-icon-right {
        position: relative;
        display: inline-block;
    }
    
    .p-chips-icon-left > i,
    .p-chips-icon-right > i,
    .p-chips-icon-left > svg,
    .p-chips-icon-right > svg,
    .p-chips-icon-left > .p-chips-prefix,
    .p-chips-icon-right > .p-chips-suffix {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
    }
    
    .p-fluid .p-chips-icon-left,
    .p-fluid .p-chips-icon-right {
        display: block;
        width: 100%;
    }
}
`,at={removeTokenIcon:"p-chips-token-icon",label:"p-chips-token-label",token:"p-chips-token p-highlight",inputToken:"p-chips-input-token",container:function(n){var i=n.props,o=n.focusedState;return S("p-inputtext p-chips-multiple-container",{"p-disabled":i.disabled,"p-focus":o})},root:function(n){var i=n.isFilled,o=n.focusedState;return S("p-chips p-component p-inputwrapper",{"p-inputwrapper-filled":i,"p-inputwrapper-focus":o})}},M=Se.extend({defaultProps:{__TYPE:"Chips",addOnBlur:null,allowDuplicate:!0,ariaLabelledBy:null,autoFocus:!1,className:null,disabled:null,id:null,inputId:null,inputRef:null,itemTemplate:null,keyfilter:null,max:null,name:null,onAdd:null,onBlur:null,onChange:null,onFocus:null,onKeyDown:null,onRemove:null,placeholder:null,readOnly:!1,removable:!0,removeIcon:null,separator:null,style:null,tooltip:null,tooltipOptions:null,value:null,children:void 0},css:{classes:at,styles:st}});function de(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)}return i}function pe(t){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?de(Object(i),!0).forEach(function(o){Qe(t,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):de(Object(i)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(i,o))})}return t}var te=u.memo(u.forwardRef(function(t,n){var i=Ce(),o=u.useContext(Ee),e=M.getProps(t,o),h=u.useState(!1),g=rt(h,2),b=g[0],c=g[1],p=M.setMetaData({props:e,state:{focused:b}}),y=p.ptm,f=p.cx,m=p.isUnstyled;Oe(M.css.styles,m,{name:"chips"});var w=u.useRef(null),I=u.useRef(null),j=u.useRef(e.inputRef),R=function(a,l){if(!(e.disabled&&e.readOnly)){var d=L(e.value),v=d.splice(l,1);k(v,l)&&(e.onRemove&&e.onRemove({originalEvent:a,value:v}),e.onChange&&e.onChange({originalEvent:a,value:d,stopPropagation:function(){a.stopPropagation()},preventDefault:function(){a.preventDefault()},target:{name:e.name,id:e.id,value:d}}))}},C=function(a,l,d){if(l&&l.trim().length){var v=e.value?L(e.value):[];if(e.allowDuplicate||v.indexOf(l)===-1){var D=!0;e.onAdd&&(D=e.onAdd({originalEvent:a,value:l})),D!==!1&&v.push(l)}T(a,v,d)}},W=function(){P.focus(j.current)},$=function(a){var l=a.target.value,d=e.value||[];if(e.onKeyDown&&e.onKeyDown(a),!a.defaultPrevented)switch(a.key){case"Backspace":j.current.value.length===0&&d.length>0&&R(a,d.length-1);break;case"Enter":l&&l.trim().length&&(!e.max||e.max>d.length)&&C(a,l,!0);break;default:e.keyfilter&&ue.onKeyPress(a,e.keyfilter),s()?a.preventDefault():e.separator===","&&(a.key===e.separator||P.isAndroid()&&a.which===229)&&C(a,l,!0);break}},T=function(a,l,d){e.onChange&&e.onChange({originalEvent:a,value:l,stopPropagation:function(){a.stopPropagation()},preventDefault:function(){a.preventDefault()},target:{name:e.name,id:e.id,value:l}}),j.current.value="",d&&a.preventDefault()},G=function(a){if(e.separator){var l=(a.clipboardData||window.clipboardData).getData("Text");if(e.keyfilter&&ue.onPaste(a,e.keyfilter),l){var d=e.value||[],v=l.split(e.separator);v=v.filter(function(D){return(e.allowDuplicate||d.indexOf(D)===-1)&&D.trim().length}),d=[].concat(L(d),L(v)),T(a,d,!0)}}},Y=function(a){c(!0),e.onFocus&&e.onFocus(a)},B=function(a){if(e.addOnBlur){var l=a.target.value,d=e.value||[];l&&l.trim().length&&(!e.max||e.max>d.length)&&C(a,l,!0)}c(!1),e.onBlur&&e.onBlur(a)},s=function(){return e.max&&e.value&&e.max===e.value.length},_=j.current&&j.current.value,N=u.useMemo(function(){return E.isNotEmpty(e.value)||E.isNotEmpty(_)},[e.value,_]),k=function(a,l){return E.getPropValue(e.removable,{value:a,index:l,props:e})};u.useImperativeHandle(n,function(){return{props:e,focus:function(){return P.focus(j.current)},getElement:function(){return w.current},getInput:function(){return j.current}}}),u.useEffect(function(){E.combinedRefs(j,e.inputRef)},[j,e.inputRef]),Ie(function(){e.autoFocus&&P.focus(j.current,e.autoFocus)});var ge=function(a,l){var d=i({className:f("removeTokenIcon"),onClick:function(q){return R(q,l)},"aria-hidden":"true"},y("removeTokenIcon")),v=e.removeIcon||u.createElement(Te,d),D=Ae.getJSXIcon(v,pe({},d),{props:e});return!e.disabled&&!e.readOnly&&k(a,l)?D:null},ye=function(a,l){var d=e.itemTemplate?e.itemTemplate(a):a,v=i({className:f("label")},y("label")),D=u.createElement("span",v,d),ne=ge(a,l),q=i({key:l,className:f("token"),"data-p-highlight":!0},y("token"));return u.createElement("li",q,D,ne)},xe=function(){var a=i({className:f("inputToken")},y("inputToken")),l=i(pe({id:e.inputId,ref:j,placeholder:e.placeholder,type:"text",name:e.name,disabled:e.disabled||s(),onKeyDown:function(v){return $(v)},onPaste:function(v){return G(v)},onFocus:function(v){return Y(v)},onBlur:function(v){return B(v)},readOnly:e.readOnly},_e),y("input"));return u.createElement("li",a,u.createElement("input",l))},be=function(){return e.value?e.value.map(ye):null},we=function(){var a=be(),l=xe(),d=i({ref:I,className:f("container",{focusedState:b}),onClick:function(D){return W()},"data-p-disabled":e.disabled,"data-p-focus":b},y("container"));return u.createElement("ul",d,a,l)},je=E.isNotEmpty(e.tooltip),De=M.getOtherProps(e),_e=E.reduceKeys(De,P.ARIA_PROPS),Ne=we(),ke=i({id:e.id,ref:w,className:S(e.className,f("root",{isFilled:N,focusedState:b})),style:e.style},y("root"));return u.createElement(u.Fragment,null,u.createElement("div",ke,Ne),je&&u.createElement(Pe,J({target:j,content:e.tooltip},e.tooltipOptions,{pt:y("tooltip")})))}));te.displayName="Chips";const ot=({visible:t,onHide:n,tableRef:i})=>{const o=ee(),e=F(Z),[h,g]=u.useState(!1),b=async f=>{const m=await Me(f);m.data.status===200?g(m.data.data):g(null)},c=fe({initialValues:{division_name:(h==null?void 0:h.division_name)||"",division_units:[]},validationSchema:Ue,onSubmit:async f=>{let m;e?(delete f.division_units,m=await Le(e,f)):m=await Be(f),(m.status===201||m.status===200)&&(y(),z.success(m.message),i.current.refreshListData())},enableReinitialize:!0}),p=[{label:e?"Update":"Add",onClick:c.handleSubmit,className:"min-w-[90px]",loading:c.isSubmitting}],y=()=>{o(H("")),c.resetForm(),g(null),n(!1)};return u.useEffect(()=>{t&&e&&b(e)},[t,e]),r.jsx(he,{header:`${e?"Update":"Add"} Division`,visible:t,onHide:y,actions:p,children:r.jsxs("div",{className:"m-auto grid w-full gap-3",children:[r.jsx(V,{htmlFor:"division_name",required:!0,title:"Division name",showError:c.errors.division_name&&c.touched.division_name,errorMessages:c.errors.division_name,children:r.jsx(K,{name:"division_name",value:c.values.division_name,className:S("w-full",{"p-invalid text-red-500":c.errors.division_name&&c.touched.division_name}),onChange:f=>c.setFieldValue("division_name",f.target.value)})}),!e&&r.jsx(V,{title:"Units",showError:c.errors.division_units&&c.touched.division_units,errorMessages:c.errors.division_units,children:r.jsxs("div",{className:"w-full",children:[r.jsx(te,{value:c.values.division_units,onChange:f=>{console.log(f.value),c.setFieldValue("division_units",f.value)},className:S("w-full",{"p-invalid text-red-500":c.errors.division_units&&c.touched.division_units}),pt:{root:{className:"w-full min-h-[39px]"},container:{className:"w-full p-1 gap-[0.2rem]"},inputToken:{className:"p-0"},token:{className:"w-max max-h-[2rem] !rounded-[0.25rem] !bg-[#37B3E0] !text-white py-1 px-2 text-sm m-0"}}}),r.jsx("p",{className:"text-secondary p-1 text-xs",children:"Type unit name and press enter(↵) to create new"})]})})]})})},lt=({visible:t,onHide:n,tableRef:i})=>{const o=ee(),e=F(Z),h=F(me),[g,b]=u.useState(!1),c=async m=>{const w=await Ve(m);w.data.status===200?b(w.data.data):b(null)},p=fe({initialValues:{division_id:e,units:[],unit_name:(g==null?void 0:g.unit_name)||""},validationSchema:Re(h),onSubmit:async m=>{let w;h?(delete m.division_id,w=await Ke(h,{division_id:m.division_id,unit_name:m.unit_name})):w=await He({division_id:m.division_id,units:m.units}),(w.status===201||w.status===200)&&(f(),z.success(w.message),i.current.refreshListData())},enableReinitialize:!0}),y=[{label:h?"Update":"Add",onClick:p.handleSubmit,className:"min-w-[90px]",loading:p.isSubmitting}],f=()=>{o(A("")),p.resetForm(),b(null),n(!1)};return u.useEffect(()=>{t&&h&&c(h)},[t,h]),r.jsx(he,{header:`${h?"Update":"Add"} Division Unit`,visible:t,onHide:f,actions:y,children:r.jsxs("div",{className:"m-auto grid w-full gap-3",children:[h&&r.jsx(V,{htmlFor:"unit_name",required:!0,title:"Unit name",showError:p.errors.unit_name&&p.touched.unit_name,errorMessages:p.errors.unit_name,children:r.jsx(K,{name:"unit_name",value:p.values.unit_name,className:S("w-full",{"p-invalid text-red-500":p.errors.unit_name&&p.touched.unit_name}),onChange:m=>p.setFieldValue("unit_name",m.target.value)})}),!h&&r.jsx(V,{title:"Units",showError:p.errors.units&&p.touched.units,errorMessages:p.errors.units,children:r.jsxs("div",{className:"w-full",children:[r.jsx(te,{value:p.values.units,onChange:m=>p.setFieldValue("units",m.value),className:S("w-full",{"p-invalid text-red-500":p.errors.units&&p.touched.units}),pt:{root:{className:"w-full min-h-[39px]"},container:{className:"w-full p-1 gap-[0.2rem]"},inputToken:{className:"p-0"},token:{className:"w-max max-h-[2rem] !rounded-[0.25rem] !bg-[#37B3E0] !text-white py-1 px-2 text-sm m-0"}}}),r.jsx("p",{className:"text-secondary p-1 text-xs",children:"Type unit name and press enter(↵) to create new"})]})})]})})},Ut=()=>{const t=ee(),n=u.useRef(null),i=u.useRef(null),o=F(Z),e=F(me),[h,g]=u.useState(""),[b,c]=u.useState(!1),[p,y]=u.useState(!1),[f,m]=u.useState(!1),[w,I]=u.useState(!1),j=async s=>await We({filterBy:"search_term",filterValue:h,page:s.page+1,records:s.rows,sortBy:s.sortField?s.sortField:"",sortOrder:s.sortField?s.sortOrder===-1?"DESC":"ASC":""}),R=async s=>await $e({divisionId:o,filterBy:"search_term",filterValue:h,page:s.page+1,records:s.rows,sortBy:s.sortField?s.sortField:"",sortOrder:s.sortField?s.sortOrder===-1?"DESC":"ASC":""}),C=s=>{let _;const N=async k=>{f?_=await Ye(k):_=await Ge(k),_.status===200&&(z.success(_.message),f?i.current.refreshListData():n.current.refreshListData())};return Fe({draggable:!1,resizable:!1,message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>N(s.id),reject:()=>{}})},W=s=>{var _;if(((_=s==null?void 0:s.division_units)==null?void 0:_.length)>0){let N;return s.division_units.map(k=>N=N?N+", "+k.unit_name:k.unit_name),N}else return"N/A"},$=s=>r.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:X,onClick:()=>{g(""),t(H(s.id)),m(!0)}}),!s.system_generated&&r.jsxs(r.Fragment,{children:[r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:oe,onClick:()=>{t(H(s.id)),c(!0)}}),r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:ce,onClick:()=>C(s)})]})]}),T=s=>s.system_generated?r.jsx("div",{className:"flex w-full items-center justify-center gap-3",children:r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:X,onClick:()=>{g(""),t(A(s.id)),m(!1),I(!0)}})}):r.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:X,onClick:()=>{g(""),t(A(s.id)),m(!1),I(!0)}}),r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:oe,onClick:()=>{t(A(s.id)),y(!0)}}),r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:ce,onClick:()=>C(s)})]}),G=[{field:"division_name",header:"Division Name",sortable:!0},{field:"division_unit",header:"Units",sortable:!0,body:W},{field:"employee_count",header:"No. Of Employees",sortable:!0,body:s=>(s==null?void 0:s.employee_count)||"N/A"},{field:"system_generated",header:"System Generated",body:s=>s!=null&&s.system_generated?"Yes":"No"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:$}],Y=[{field:"unit_name",header:"Unit Name",sortable:!0},{field:"user_count",header:"No. Of Employees",sortable:!0,body:s=>(s==null?void 0:s.user_count)||"N/A"},{field:"system_generated",header:"System Generated",body:s=>s.system_generated?"Yes":"No"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:T}],B=()=>{f?y(!0):c(!0)};return r.jsxs("div",{className:"flex w-full flex-col",children:[!f&&!w&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Divisions"}),r.jsxs(re,{className:"flex w-full flex-col",children:[r.jsxs("div",{className:"flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[r.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[r.jsx(K,{placeholder:"Search division name",value:h,onChange:s=>g(s.target.value)}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(O,{icon:"pi pi-times",severity:"danger",onClick:()=>{g(""),n.current&&n.current.refreshListData()}}),r.jsx(O,{icon:"pi pi-search",disabled:!h,onClick:()=>{n.current&&n.current.refreshListData()}})]})]}),r.jsx(O,{raised:!0,label:"Add Division",icon:r.jsx("img",{src:le}),onClick:B})]}),r.jsx(se,{dataHandler:j,id:"organisational_divisions",headers:G,ref:n})]})]}),f&&!w&&r.jsxs(r.Fragment,{children:[r.jsx(ie,{className:"w-max gap-2 border-none px-0 !font-extralight !text-black shadow-none",icon:r.jsx("img",{src:ae}),link:!0,label:"Go Back",onClick:()=>{g(""),t(H("")),m(!1)}}),r.jsxs(re,{className:"flex w-full flex-col",children:[r.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[r.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[r.jsx(K,{placeholder:"Search unit name",value:h,onChange:s=>g(s.target.value)}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(O,{icon:"pi pi-times",severity:"danger",onClick:()=>{g(""),i.current&&i.current.refreshListData()}}),r.jsx(O,{icon:"pi pi-search",disabled:!h,onClick:()=>{i.current&&i.current.refreshListData()}})]})]}),r.jsx(O,{raised:!0,label:"Add Unit",icon:r.jsx("img",{src:le}),onClick:B})]}),r.jsx(se,{dataHandler:R,id:"division_units",headers:Y,ref:i})]})]}),w&&!f&&r.jsxs(r.Fragment,{children:[r.jsx(ie,{className:"w-max gap-2 border-none px-0 !font-extralight !text-black shadow-none",icon:r.jsx("img",{src:ae}),link:!0,label:"Go Back",onClick:()=>{t(A("")),m(!0),I(!1)}}),r.jsx(qe,{division:o,divisionUnit:e,hideAddEmployee:!0})]}),r.jsx(ot,{visible:b,onHide:()=>c(!1),tableRef:n}),r.jsx(lt,{visible:p,onHide:()=>y(!1),tableRef:i})]})};export{Ut as default};
