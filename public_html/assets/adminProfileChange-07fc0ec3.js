import{r as i,j as e,G as m,af as g,$ as b}from"./index-3ec7abe5.js";import{C as _,D as N}from"./dropdown.esm-1ad10373.js";import{T as S}from"./index-c74eb1f3.js";import{T as U}from"./index-b2a6305f.js";import{l as Y,m as B,n as F,o as O}from"./api-41c2d9cf.js";import{I as M}from"./inputtext.esm-e49a03d7.js";import{C as p}from"./index-3d6f48ca.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";const T=()=>{const l=i.useRef(null),[n,d]=i.useState("");i.useState("");const[u,w]=i.useState(null),[f,x]=i.useState(null),C=async s=>await Y({filterBy:"search_term",filterValue:n,page:s.page+1,records:s.rows,sortBy:s.sortField?s.sortField:"",sortOrder:s.sortField?s.sortOrder===-1?"DESC":"ASC":"",status:f}),R=async s=>{var a,r;const t=await B();if(t.status==200){const o=(r=(a=t==null?void 0:t.data)==null?void 0:a.data)==null?void 0:r.map(c=>({code:c.id,label:c.name}));w(o)}},P=s=>{var a,r;const t=async o=>{const c=await F(o);c.status===200&&(b.success(c.message),l.current.refreshListData())};return g({draggable:!1,resizable:!1,message:e.jsxs("p",{children:["Approve profile update request for ",e.jsx("span",{className:"font-bold",children:(r=(a=s==null?void 0:s.profile_change_record)==null?void 0:a.user)==null?void 0:r.employee_name}),"?"]}),header:"Approval Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-success",rejectClassName:"p-button-link mr-2",accept:()=>t(s.id),reject:()=>{}})},q=s=>{var a,r;const t=async o=>{const c=await O(o);c.status===200&&(b.success(c.message),l.current.refreshListData())};return g({draggable:!1,resizable:!1,message:e.jsxs("p",{children:["Reject profile update request for ",e.jsx("span",{className:"font-bold",children:(r=(a=s==null?void 0:s.profile_change_record)==null?void 0:a.user)==null?void 0:r.employee_name}),"?"]}),header:"Recjection Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>t(s.id),reject:()=>{}})},h=(s,t)=>{const a={};for(const r in s)if(s.hasOwnProperty(r))if(t.hasOwnProperty(r))if(typeof s[r]=="object"&&typeof t[r]=="object"){const o=h(s[r],t[r]);Object.keys(o).length>0&&(a[r]=o)}else s[r]!==t[r]&&(a[r]=s[r]);else a[r]=s[r];for(const r in t)t.hasOwnProperty(r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);return a},j=s=>{const t=(a,r)=>{switch(a){case"employee_name":return e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",r||"---"]},a);case"dob_adhaar":return e.jsxs("p",{children:[e.jsx("strong",{children:"D.O.B Documented:"})," ",r?m(r).format("DD MMM, YYYY"):"---"]},a);case"dob_celebrated":return e.jsxs("p",{children:[e.jsx("strong",{children:"D.O.B Celebrated:"})," ",r?m(r).format("DD MMM, YYYY"):"---"]},a);case"employee_gender_id":return e.jsxs("p",{children:[e.jsx("strong",{children:"Gender:"})," ",r==null?void 0:r.name]},a);case"blood_group":return e.jsxs("p",{children:[e.jsx("strong",{children:"Blood Group:"})," ",r||"---"]},a);case"religion":return e.jsxs("p",{children:[e.jsx("strong",{children:"Religion:"})," ",r||"---"]},a);case"nationality":return e.jsxs("p",{children:[e.jsx("strong",{children:"Nationality:"})," ",r||"---"]},a);case"employee_personal_email":return e.jsxs("p",{children:[e.jsx("strong",{children:"Personal Email:"})," ",r||"---"]},a);case"alternate_email":return e.jsxs("p",{children:[e.jsx("strong",{children:"Alternate Email:"})," ",r||"---"]},a);case"phone":return e.jsxs("p",{children:[e.jsx("strong",{children:"Personal Phone:"})," ",r||"---"]},a);case"alternate_contact":return e.jsxs("p",{children:[e.jsx("strong",{children:"Alternate Phone:"})," ",r||"---"]},a);case"bank_name":return e.jsxs("p",{children:[e.jsx("strong",{children:"Bank NAme:"})," ",r||"---"]},a);case"bank_branch":return e.jsxs("p",{children:[e.jsx("strong",{children:"Branch Name:"})," ",r||"---"]},a);case"ifsc_code":return e.jsxs("p",{children:[e.jsx("strong",{children:"IFSC Code:"})," ",r||"---"]},a);case"account_number":return e.jsxs("p",{children:[e.jsx("strong",{children:"Account Number:"})," ",r||"---"]},a);case"account_holder_name":return e.jsxs("p",{children:[e.jsx("strong",{children:"Account Holder Name:"})," ",r||"---"]},a);case"adhaar_number":return e.jsxs("p",{children:[e.jsx("strong",{children:"Aadhaar Number:"})," ",r||"---"]},a);case"pan_number":return e.jsxs("p",{children:[e.jsx("strong",{children:"PAN Number:"})," ",r||"---"]},a)}};return e.jsx("div",{className:"flex w-full flex-col",children:Object.keys(s).map(a=>t(a,s[a]))})},A=s=>{if(s==1)return"F6BB42";if(s==2)return"00B087";if(s==3)return"FF684F"},D=[{field:"employee_name",header:"Requester",sortable:!0,body:s=>{var t;return((t=s==null?void 0:s.profile_change_requester)==null?void 0:t.employee_name)||"N/A"}},{field:"section",header:"Section",sortable:!0,body:s=>{var t;return((t=s==null?void 0:s.change)==null?void 0:t.section)||"N/A"}},{field:"previous",header:"Previous",body:s=>{var t;return(t=s==null?void 0:s.profile_change_record)!=null&&t.previous?j(h(s==null?void 0:s.previous,s==null?void 0:s.change)):"N/A"}},{field:"updated",header:"Updated",body:s=>s!=null&&s.change?j(h(s==null?void 0:s.change,s==null?void 0:s.previous)):"N/A"},{field:"status",header:"Status",body:s=>{var t,a;return e.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[e.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${A((t=s==null?void 0:s.approval_status)==null?void 0:t.id)}]`}),e.jsx("span",{className:"text-sm",children:(a=s==null?void 0:s.approval_status)==null?void 0:a.name})]})}},{field:"actions",header:"Actions",alignHeader:"center",body:s=>{var t,a,r,o;return(s==null?void 0:s.status)==1?e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row justify-center",children:[e.jsx(p,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Approve",severity:"success",onClick:()=>P(s)}),e.jsx(p,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Reject",severity:"danger",onClick:()=>q(s)})]}):e.jsxs("div",{className:"ap-3 md:flex-row text-center",children:[e.jsxs("p",{children:[(t=s==null?void 0:s.ProfileChangeRequestHistories[0])==null?void 0:t.action," by ",(r=(a=s==null?void 0:s.ProfileChangeRequestHistories[0])==null?void 0:a.user)==null?void 0:r.employee_name]}),e.jsx("p",{children:m((o=s==null?void 0:s.ProfileChangeRequestHistories[0])==null?void 0:o.createdAt).format("YYYY-MM-DD, HH:mm:ss")})]})}}];return i.useEffect(()=>{R()},[]),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Profile Update Requests"}),e.jsxs(_,{className:"flex w-full flex-col",children:[e.jsx("div",{className:"my-2 flex flex-col justify-between p-3 md:flex-row",children:e.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[e.jsx(M,{placeholder:"Search requester name",value:n,onChange:s=>d(s.target.value)}),e.jsx(N,{placeholder:"Status",className:"w-full md:!w-fit",options:u,optionLabel:"label",optionValue:"code",value:f,onChange:s=>{x(s.value)}}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(p,{icon:"pi pi-times",severity:"danger",onClick:()=>{x(null),d(""),l.current&&l.current.refreshListData()}}),e.jsx(p,{icon:"pi pi-search",disabled:!n&&!f,onClick:()=>{l.current&&l.current.refreshListData()}})]})]})}),e.jsx(U,{dataHandler:C,id:"regularisation_requests",headers:D,ref:l})]})]})},W=()=>{const[l,n]=i.useState(0),d=[{id:1,label:"Profile Change Requests"}];return e.jsx("div",{className:"grid w-full",children:e.jsxs(_,{className:"flex w-full flex-col gap-5 overflow-hidden md:col-span-6",children:[e.jsx(S,{activeIndex:l,onTabChange:u=>n(u.index),model:d}),l===0&&e.jsx(T,{})]})})};export{W as default};
