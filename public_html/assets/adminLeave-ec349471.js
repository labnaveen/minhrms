import{$ as _,j as s,f as B,r as l,G as d,af as v}from"./index-3ec7abe5.js";import{C as L,D as w}from"./dropdown.esm-1ad10373.js";import{T as E}from"./index-c74eb1f3.js";import{T as V}from"./index-b2a6305f.js";import{c as I,d as O,f as W,e as $,g as G}from"./api-41c2d9cf.js";import{C as b}from"./index-3d6f48ca.js";import{I as Q}from"./inputtext.esm-e49a03d7.js";import{C as J}from"./calendar.esm-f987a87a.js";import{B as K}from"./index-36dd5a0c.js";import{u as P,c as U}from"./validationSchemas-9cdf4188.js";import{I as X}from"./inputtextarea.esm-51dfddb5.js";import{L as Z}from"./index-37ade0e2.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./index.esm-be3d6ae7.js";const z=({visible:t,onHide:i,tableRef:m,leaveRequestData:a})=>{var x,u;const o=P({initialValues:{reject_reason:""},validationSchema:U(a==null?void 0:a.rejection_reason_mandatory),onSubmit:async p=>{const j=await I(a.id,p);j.status===200&&(c(),_.success(j.message),m.current.refreshListData())},enableReinitialize:!0}),c=()=>{i()},n=[{label:"No",onClick:c,className:"px-3 py-2 w-fit p-button-link"},{label:"Yes",severity:"danger",loading:o.isSubmitting,onClick:o.handleSubmit,className:"px-3 py-2 w-fit"}];return s.jsx(K,{className:"md:w-[30%]",header:"Rejection Confirmation",visible:t,onHide:c,actions:n,children:s.jsxs("div",{className:"flex w-full flex-col gap-3",children:[s.jsxs("p",{children:["Reject leave request for ",s.jsx("span",{className:"font-bold",children:(u=(x=a==null?void 0:a.leave_record)==null?void 0:x.requester)==null?void 0:u.employee_name}),"?"]}),s.jsx(Z,{required:a==null?void 0:a.rejection_reason_mandatory,title:"Reason",htmlFor:"reject_reason",showError:o.errors.reject_reason&&o.touched.reject_reason,errorMessages:o.errors.reject_reason,children:s.jsx(X,{name:"reject_reason",rows:2,autoResize:!0,className:B("w-full",{"p-invalid text-red-500":o.errors.reject_reason&&o.touched.reject_reason}),onChange:p=>{o.setFieldValue("reject_reason",p.target.value)}})})]})})},ee=()=>{const t=l.useRef(null),[i,m]=l.useState(null),[a,o]=l.useState(""),[c,n]=l.useState(""),[x,u]=l.useState([]),[p,j]=l.useState(null),[R,g]=l.useState(!1),[C,S]=l.useState([]),[F,D]=l.useState(null),T=async()=>{const e=await O();e.status===200?u(e.data.data):u([])},A=async()=>{const e=await W();console.log("Response: ",e),e.status==200&&S(e.data.data)},q=async e=>await $({month:i?d(i).month()+1:"",year:i?d(i).year():"",filterBy:a,filterValue:c,page:e.page+1,records:e.rows,sortBy:e.sortField?e.sortField:"",sortOrder:e.sortField?e.sortOrder===-1?"DESC":"ASC":""}),M=e=>{var f,h;const r=async y=>{const N=await G(y);N.status===200&&(_.success(N.message),t.current.refreshListData())};return v({draggable:!1,resizable:!1,message:s.jsxs("p",{children:["Approve leave request for ",s.jsx("span",{className:"font-bold",children:(h=(f=e==null?void 0:e.leave_record)==null?void 0:f.requester)==null?void 0:h.employee_name}),"?"]}),header:"Approval Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-success",rejectClassName:"p-button-link mr-2",accept:()=>r(e.id),reject:()=>{}})},Y=e=>{j(e),g(!0)},H=e=>{if(e==1)return"F6BB42";if(e==2)return"00B087";if(e==3)return"FF684F"},k=[{field:"employee_name",header:"Requester",sortable:!0,body:e=>{var r;return((r=e==null?void 0:e.requester)==null?void 0:r.employee_name)||"N/A"}},{field:"leave_type",header:"Leave Type",sortable:!0,body:e=>{var r;return((r=e==null?void 0:e.leave_type)==null?void 0:r.leave_type_name)||"N/A"}},{field:"day_type",header:"Day Type",sortable:!0,body:e=>{var r;return((r=e==null?void 0:e.day_type)==null?void 0:r.name)||"N/A"}},{field:"from",header:"From",sortable:!0,body:e=>d(e==null?void 0:e.start_date).format("ddd, MMM DD, YYYY")},{field:"to",header:"To",sortable:!0,body:e=>d(e==null?void 0:e.end_date).format("ddd, MMM DD, YYYY")},{field:"reason",header:"Reason",body:e=>(e==null?void 0:e.reason)||"N/A"},{field:"status",header:"Status",alignHeader:"center",body:e=>{var r;return s.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[s.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${H(e.status)}]`}),s.jsx("span",{className:"text-sm",children:(r=e==null?void 0:e.approval_status)==null?void 0:r.name})]})}},{field:"actions",header:"Actions",alignHeader:"center",body:e=>{var r,f,h,y;return e.status==1?s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row justify-center",children:[s.jsx(b,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Approve",severity:"success",onClick:()=>M(e)}),s.jsx(b,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Reject",severity:"danger",onClick:()=>Y(e)})]}):s.jsxs("div",{className:"ap-3 md:flex-row text-center",children:[s.jsxs("p",{children:[(r=e==null?void 0:e.LeaveRequestHistories[0])==null?void 0:r.action," by ",(h=(f=e==null?void 0:e.LeaveRequestHistories[0])==null?void 0:f.user)==null?void 0:h.employee_name]}),s.jsx("p",{children:d((y=e==null?void 0:e.LeaveRequestHistories[0])==null?void 0:y.createdAt).format("YYYY-MM-DD, HH:mm:ss")})]})}}];return l.useEffect(()=>{T(),A()},[]),l.useEffect(()=>{t.current&&t.current.refreshListData()},[i]),s.jsxs("div",{className:"flex w-full flex-col",children:[s.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Leave Requests"}),s.jsxs(L,{className:"flex w-full flex-col",children:[s.jsx("div",{className:"my-2 flex flex-col justify-between p-3 md:flex-row",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[s.jsx(J,{className:"w-full md:!w-fit",name:"filter_date",readOnlyInput:!0,view:"month",dateFormat:"M yy",placeholder:"Select month",maxDate:d().toDate(),value:i,onChange:e=>{o(""),n(""),m(e.value)}}),a==="search_term"&&s.jsx(Q,{className:"w-full md:!w-fit",placeholder:"Search",value:c,onChange:e=>n(e.target.value)}),a==="day_type"&&s.jsx(w,{className:"w-full md:!w-fit",placeholder:"Day Type",options:x,optionLabel:"name",optionValue:"id",value:c,onChange:e=>{n(e.value)}}),a==="status"&&s.jsx(w,{className:"w-full md:!w-fit",placeholder:"Status",options:C,optionLabel:"name",optionValue:"id",value:F,onChange:e=>{n(e.value),D(e.value)}}),s.jsx(w,{placeholder:"Filter by",className:"w-full md:!w-fit",options:[{label:"Employee Name",code:"search_term"},{label:"Day Type",code:"day_type"},{label:"Status",code:"status"}],optionLabel:"label",optionValue:"code",value:a,onChange:e=>{n(""),o(e.value)}}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(b,{icon:"pi pi-times",severity:"danger",disabled:!a,onClick:()=>{o(""),n(""),t.current&&t.current.refreshListData()}}),s.jsx(b,{icon:"pi pi-search",disabled:!c||!a,onClick:()=>{t.current&&t.current.refreshListData()}})]})]})}),s.jsx(V,{dataHandler:q,id:"regularisation_requests",headers:k,ref:t})]}),s.jsx(z,{visible:R,onHide:()=>g(!1),leaveRequestData:p,tableRef:t})]})},xe=()=>{const[t,i]=l.useState(0),m=[{id:1,label:"Leave Requests"}];return s.jsx("div",{className:"grid w-full",children:s.jsxs(L,{className:"flex w-full flex-col gap-5 overflow-hidden md:col-span-6",children:[s.jsx(E,{activeIndex:t,onTabChange:a=>i(a.index),model:m}),t===0&&s.jsx(ee,{})]})})};export{xe as default};
