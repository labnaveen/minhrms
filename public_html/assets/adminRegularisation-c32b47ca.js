import{r as t,j as e,G as i,af as _,$ as w}from"./index-3ec7abe5.js";import{C as q,D as E}from"./dropdown.esm-1ad10373.js";import{T as $}from"./index-c74eb1f3.js";import{T as B}from"./index-b2a6305f.js";import{f as Y,a as k,b as M,r as L}from"./api-41c2d9cf.js";import{C as n}from"./index-3d6f48ca.js";import{C as O}from"./calendar.esm-f987a87a.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./inputtext.esm-e49a03d7.js";import"./index.esm-be3d6ae7.js";const V=()=>{const o=t.useRef(null),[l,f]=t.useState(null),[d,p]=t.useState(""),[x,h]=t.useState(""),[y,g]=t.useState([]),[R,j]=t.useState(null),N=async()=>{const s=await Y();s.status===200?g(s.data.data):g([])},D=async s=>await k({month:l?i(l).month()+1:"",year:l?i(l).year():"",filterBy:d,filterValue:x,page:s.page+1,records:s.rows,sortBy:s.sortField?s.sortField:"",sortOrder:s.sortField?s.sortOrder===-1?"DESC":"ASC":""}),C=s=>{if(s==1)return"F6BB42";if(s==2)return"00B087";if(s==3)return"FF684F"},A=s=>!(s!=null&&s.recorded_in_time)&&!(s!=null&&s.recorded_out_time)?"---":!(s!=null&&s.recorded_in_time)&&(s!=null&&s.recorded_out_time)?`N/A - ${i(s==null?void 0:s.recorded_out_time,"HH:mm:ss").format("hh:mm A")}`:s!=null&&s.recorded_in_time&&!(s!=null&&s.recorded_out_time)?`${i(s==null?void 0:s.recorded_in_time,"HH:mm:ss").format("hh:mm A")} - N/A`:`${i.utc(s==null?void 0:s.recorded_in_time).local().format("hh:mm A")} - ${i.utc(s==null?void 0:s.recorded_out_time).local().format("hh:mm A")}`,S=s=>(console.log("Event: ",s),`${i.utc(s==null?void 0:s.in_time).local().format("hh:mm A")} - ${i.utc(s==null?void 0:s.out_time).local().format("hh:mm A")}`),b=s=>{if(s==1)return"F44336";if(s==2)return"BDED16";if(s==3)return"4CAF50";if(s==4)return"D9DDE2"},F=s=>{var a,c;const r=async u=>{const m=await M(u);m.status===200&&(w.success(m.message),o.current.refreshListData())};return _({draggable:!1,resizable:!1,message:e.jsxs("p",{children:["Approve regularisation request for ",e.jsx("span",{className:"font-bold",children:(c=(a=s==null?void 0:s.regularization_record)==null?void 0:a.Requester)==null?void 0:c.employee_name}),"?"]}),header:"Approval Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-success",rejectClassName:"p-button-link mr-2",accept:()=>r(s.id),reject:()=>{}})},T=s=>{var a,c;const r=async u=>{const m=await L(u);m.status===200&&(w.success(m.message),o.current.refreshListData())};return _({draggable:!1,resizable:!1,message:e.jsxs("p",{children:["Reject regularisation request for ",e.jsx("span",{className:"font-bold",children:(c=(a=s==null?void 0:s.regularization_record)==null?void 0:a.Requester)==null?void 0:c.employee_name}),"?"]}),header:"Recjection Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>r(s.id),reject:()=>{}})},H=[{field:"employee_name",header:"Requester",sortable:!0,body:s=>{var r;return((r=s==null?void 0:s.Requester)==null?void 0:r.employee_name)||"N/A"}},{field:"date",header:"Date",sortable:!0,body:s=>i(s==null?void 0:s.date).format("ddd, MMM DD, YYYY")},{field:"recorded_time",header:"Recorded Time",body:A},{field:"requested_time",header:"Requested Time",body:S},{field:"recorded_status",header:"Recorded Status",body:s=>{var r,a;return e.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[e.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${b((r=s==null?void 0:s.recorded_status)==null?void 0:r.id)}]`}),e.jsx("span",{className:"text-sm",children:((a=s==null?void 0:s.recorded_status)==null?void 0:a.name)||"---"})]})}},{field:"request_status",header:"Requested Status",sortable:!0,body:s=>{var r,a;return e.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[e.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${b((r=s==null?void 0:s.Request_status)==null?void 0:r.id)}]`}),e.jsx("span",{className:"text-sm",children:((a=s==null?void 0:s.Request_status)==null?void 0:a.name)||"---"})]})}},{field:"reason",header:"Reason",body:s=>(s==null?void 0:s.reason)||"N/A"},{field:"status",header:"Status",body:s=>{var r,a;return e.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[e.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${C((r=s==null?void 0:s.approval_status)==null?void 0:r.id)}]`}),e.jsx("span",{className:"text-sm",children:(a=s==null?void 0:s.approval_status)==null?void 0:a.name})]})}},{field:"actions",header:"Actions",alignHeader:"center",body:s=>{var r,a,c,u;return s.status==1?e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[e.jsx(n,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Approve",severity:"success",onClick:()=>F(s)}),e.jsx(n,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Reject",severity:"danger",onClick:()=>T(s)})]}):e.jsxs("div",{className:"ap-3 md:flex-row text-center",children:[e.jsxs("p",{children:[(r=s==null?void 0:s.RegularisationRequestHistories[0])==null?void 0:r.action," by ",(c=(a=s==null?void 0:s.RegularisationRequestHistories[0])==null?void 0:a.user)==null?void 0:c.employee_name]}),e.jsx("p",{children:i((u=s==null?void 0:s.RegularisationRequestHistories[0])==null?void 0:u.createdAt).format("YYYY-MM-DD, HH:mm:ss")})]})}}];return t.useEffect(()=>{N()},[]),t.useEffect(()=>{o.current&&o.current.refreshListData()},[l]),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Regularisation Requests"}),e.jsxs(q,{className:"flex w-full flex-col",children:[e.jsx("div",{className:"my-2 flex flex-row justify-between p-3",children:e.jsxs("div",{className:"flex w-full flex-col items-center gap-3 md:flex-row",children:[e.jsx(O,{className:"w-full md:!w-fit",name:"filter_date",readOnlyInput:!0,view:"month",dateFormat:"M yy",placeholder:"Select month",maxDate:i().toDate(),value:l,onChange:s=>{p(""),h(""),f(s.value)}}),e.jsx(E,{placeholder:"Status",className:"w-full md:!w-fit",options:y,optionLabel:"name",optionValue:"id",value:d,onChange:s=>{h(""),p(s.value),j(s.value)}}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(n,{icon:"pi pi-times",severity:"danger",disabled:!d&&!l&&!R,onClick:()=>{p(""),f(null),h(""),j(null),o.current&&o.current.refreshListData()}}),e.jsx(n,{icon:"pi pi-search",disabled:!x||!d||!R,onClick:()=>{o.current&&o.current.refreshListData()}})]})]})}),e.jsx(B,{dataHandler:D,id:"regularisation_requests",headers:H,ref:o})]})]})},v=()=>{const[o,l]=t.useState(0),f=[{id:1,label:"Regularisation Requests"}];return e.jsx("div",{className:"grid w-full",children:e.jsxs(q,{className:"flex w-full flex-col gap-5 overflow-hidden md:col-span-6",children:[e.jsx($,{activeIndex:o,onTabChange:d=>l(d.index),model:f}),o===0&&e.jsx(V,{})]})})};export{v as default};
