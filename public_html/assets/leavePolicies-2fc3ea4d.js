import{r as u,v as L,c4 as fe,$ as U,c5 as te,j as e,f as h,G as B,c6 as Q,c7 as G,c8 as ve,c9 as se,B as xe,af as ee}from"./index-3ec7abe5.js";import{D as V,C as ae}from"./dropdown.esm-1ad10373.js";import{T as le}from"./index-b2a6305f.js";import{A as ge}from"./arrow-back-2554853d.js";import{E as J}from"./edit-c01b3e15.js";import{E as ye}from"./eye-open-81f9d166.js";import{P as re}from"./plus-b36a0702.js";import{T as K}from"./trash-4a28e917.js";import{T as we}from"./index-c74eb1f3.js";import{C as O}from"./index-3d6f48ca.js";import{u as X,v as je,L as be,w as Fe}from"./validationSchemas-9cdf4188.js";import{I as C}from"./inputtext.esm-e49a03d7.js";import{C as S}from"./checkbox.esm-7c1abfc1.js";import{I as v}from"./inputswitch.esm-65362ee3.js";import{B as Z}from"./index-36dd5a0c.js";import{L as i}from"./index-37ade0e2.js";import{n as Ce,o as ke,p as Ne,q as ne,s as Ve,t as Ae,v as Se,w as oe,x as Ee,y as Me,z as Ie,A as Re,B as qe,C as Be,D as Ye,E as Pe,F as He,G as Oe,H as Le,I as Ue,J as $e,K as Ge}from"./api-f3ada6c1.js";import{u as W}from"./useDispatch-1aeda00f.js";import{I as q}from"./paginator.esm-634e02d4.js";import{C as ie}from"./calendar.esm-f987a87a.js";import"./index.esm-9e3aa09b.js";import"./index.esm-be3d6ae7.js";const We=({visible:p,onHide:x,tableRef:j})=>{const E=W(),[n,g]=u.useState(null),s=L(fe),[f,r]=u.useState([]),[F,w]=u.useState([]),k=async()=>{const _=await Ne();r(_.status===200?_.data.data:[])},M=async()=>{const _=await ne();w(_.status===200?_.data.data:[])},N=async _=>{const y=await Ve(_);y.data.status===200?g(y.data.data):g(null)},c=X({initialValues:{policy_name:(n==null?void 0:n.policy_name)||"",policy_description:(n==null?void 0:n.policy_description)||"",leave_calendar_from:(n==null?void 0:n.leave_calendar_from)||1,custom_month:(n==null?void 0:n.custom_month)||1,proxy_leave_application:(n==null?void 0:n.proxy_leave_application)||!1,leave_request_status:(n==null?void 0:n.leave_request_status)||!1,leave_balance_status:(n==null?void 0:n.leave_balance_status)||!1,contact_number_allowed:(n==null?void 0:n.contact_number_allowed)||!1,contact_number_mandatory:(n==null?void 0:n.contact_number_mandatory)||!1,reason_for_leave:(n==null?void 0:n.reason_for_leave)||!1,reason_for_leave_mandatory:(n==null?void 0:n.reason_for_leave_mandatory)||!1,leave_rejection_reason:(n==null?void 0:n.leave_rejection_reason)||!1},validationSchema:je,onSubmit:async _=>{let y;s?y=await ke(s,_):y=await Ce(_),(y.status===201||y.status===200)&&(A(),U.success(y.message),j.current.refreshListData())},enableReinitialize:!0}),b=[{label:s?"Update":"Add",onClick:c.handleSubmit,className:"min-w-[90px]",loading:c.isSubmitting}],A=()=>{E(te("")),c.resetForm(),g(null),x(!1)};return u.useEffect(()=>{p&&k()},[p]),u.useEffect(()=>{p&&s&&N(s)},[p,s]),u.useEffect(()=>{p&&c.values.leave_calendar_from===3&&F.length===0&&M()},[p,c.values.leave_calendar_from]),e.jsx(Z,{header:`${s?"Update":"Add"} Leave Configuration`,visible:p,onHide:A,actions:b,children:e.jsxs("div",{className:"m-auto grid w-full gap-3 md:grid-cols-2",children:[e.jsx(i,{htmlFor:"policy_name",required:!0,title:"Configuration Name",showError:c.errors.policy_name&&c.touched.policy_name,errorMessages:c.errors.policy_name,children:e.jsx(C,{name:"policy_name",value:c.values.policy_name,className:h("w-full",{"p-invalid text-red-500":c.errors.policy_name&&c.touched.policy_name}),onChange:_=>c.setFieldValue("policy_name",_.target.value)})}),e.jsx(i,{htmlFor:"policy_description",required:!0,title:"Description",showError:c.errors.policy_description&&c.touched.policy_description,errorMessages:c.errors.policy_description,children:e.jsx(C,{name:"policy_description",value:c.values.policy_description,className:h("w-full",{"p-invalid text-red-500":c.errors.policy_description&&c.touched.policy_description}),onChange:_=>c.setFieldValue("policy_description",_.target.value)})}),e.jsx(i,{className:h({"md:col-span-2":c.values.leave_calendar_from!=3}),required:!0,title:"Holiday Calendar Interval",children:e.jsx(V,{options:f,optionLabel:"name",optionValue:"id",value:c.values.leave_calendar_from,onChange:_=>c.setFieldValue("leave_calendar_from",_.value)})}),c.values.leave_calendar_from===3&&e.jsx(i,{required:!0,title:"Select Start Month",children:e.jsx(V,{options:F,optionLabel:"name",optionValue:"id",value:c.values.custom_month,onChange:_=>c.setFieldValue("custom_month",_.value)})}),e.jsx(i,{className:"col-span-2",required:!0,title:"Allow Proxy Leave Application",children:e.jsx(v,{name:"proxy_leave_application",checked:c.values.proxy_leave_application,onChange:_=>c.setFieldValue("proxy_leave_application",_.value)})}),e.jsxs(i,{className:"col-span-2",title:"Control leave page displaying",children:[e.jsx(i,{title:"Leaves Request Status",inlineEnd:!0,children:e.jsx(S,{className:"self-center",name:"leave_page_display",inputId:"leave_request_status",onChange:_=>c.setFieldValue("leave_request_status",_.checked),checked:c.values.leave_request_status})}),e.jsx(i,{title:"Leaves Balance Status",inlineEnd:!0,children:e.jsx(S,{className:"self-center",name:"leave_page_display",inputId:"leave_balance_status",onChange:_=>c.setFieldValue("leave_balance_status",_.checked),checked:c.values.leave_balance_status})})]}),e.jsxs(i,{className:"col-span-2",title:"Fields for leave application",children:[e.jsx(i,{title:"Contact Number",children:e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx(v,{name:"contact_number_allowed",checked:c.values.contact_number_allowed,onChange:_=>c.setFieldValue("contact_number_allowed",_.value)}),e.jsx(S,{disabled:!c.values.contact_number_allowed,className:"self-center",name:"leave_application_fields",inputId:"contact_number_mandatory",onChange:_=>c.setFieldValue("contact_number_mandatory",_.checked),checked:c.values.contact_number_mandatory}),e.jsx("label",{className:"m-0 self-center text-xs",children:"Mandatory"})]})}),e.jsx(i,{title:"Reason For Leave",children:e.jsxs("div",{className:"flex w-full gap-2",children:[e.jsx(v,{name:"reason_for_leave",checked:c.values.reason_for_leave,onChange:_=>c.setFieldValue("reason_for_leave",_.value)}),e.jsx(S,{disabled:!c.values.reason_for_leave,className:"self-center",name:"leave_application_fields",inputId:"reason_for_leave_mandatory",onChange:_=>c.setFieldValue("reason_for_leave_mandatory",_.checked),checked:c.values.reason_for_leave_mandatory}),e.jsx("label",{className:"m-0 self-center text-xs",children:"Mandatory"})]})})]}),e.jsx(i,{title:"Mandatory Leave Rejection Reason",children:e.jsx(v,{name:"leave_rejection_reason",checked:c.values.leave_rejection_reason,onChange:_=>c.setFieldValue("leave_rejection_reason",_.value)})})]})})},Je=({visible:p,onHide:x,tableRef:j})=>{const E=W(),n=4,[g]=u.useState(B().format("YYYY-MM-DD")),[s,f]=u.useState(1),[r,F]=u.useState(null),w=L(Q),[k,M]=u.useState([]),[N,c]=u.useState([]),[b,A]=u.useState([]),_=async()=>{const l=await oe(),m=await Ee(),I=await Me();M(l.status===200?l.data.data:[]),c(m.status===200?m.data.data:[]),A(I.status===200?I.data.data:[])},y=async l=>{const m=await Ie(l);m.data.status===200?F(m.data.data):F(null)},a=X({initialValues:{leave_type_name:(r==null?void 0:r.leave_type_name)||"",negative_balance:(r==null?void 0:r.negative_balance)||!1,max_leave_allowed_in_negative_balance:(r==null?void 0:r.max_leave_allowed_in_negative_balance)||1,max_days_per_leave:(r==null?void 0:r.max_days_per_leave)||1,max_days_per_month:(r==null?void 0:r.max_days_per_month)||1,allow_half_days:(r==null?void 0:r.allow_half_days)||!1,leave_application_after:(r==null?void 0:r.leave_application_after)||1,custom_leave_application_date:(r==null?void 0:r.custom_leave_application_date)||g,application_on_holidays:(r==null?void 0:r.application_on_holidays)||!1,restriction_for_application:(r==null?void 0:r.restriction_for_application)||!1,limit_back_dated_application:(r==null?void 0:r.limit_back_dated_application)||1,notice_for_application:(r==null?void 0:r.notice_for_application)||1,auto_approval:(r==null?void 0:r.auto_approval)||!1,auto_action_after:(r==null?void 0:r.auto_action_after)||1,auto_approval_action:(r==null?void 0:r.auto_approval_action)||2,supporting_document_mandatory:(r==null?void 0:r.supporting_document_mandatory)||!1,prorated_accrual_first_month:(r==null?void 0:r.prorated_accrual_first_month)||!1,prorated_rounding:(r==null?void 0:r.prorated_rounding)||1,prorated_rounding_factor:(r==null?void 0:r.prorated_rounding_factor)||0,encashment_yearly:(r==null?void 0:r.encashment_yearly)||!1,max_leaves_for_encashment:(r==null?void 0:r.max_leaves_for_encashment)||1,carry_forward_yearly:(r==null?void 0:r.carry_forward_yearly)||!1,carry_forward_rounding:(r==null?void 0:r.carry_forward_rounding)||1,carry_forward_rounding_factor:(r==null?void 0:r.carry_forward_rounding_factor)||0,intra_cycle_carry_forward:(r==null?void 0:r.intra_cycle_carry_forward)||!1,prefix_postfix_weekly_off_sandwhich_rule:(r==null?void 0:r.prefix_postfix_weekly_off_sandwhich_rule)||!1,prefix_postfix_holiday_sandwhich_rule:(r==null?void 0:r.prefix_postfix_holiday_sandwhich_rule)||!1,inbetween_weekly_off_sandwhich_rule:(r==null?void 0:r.inbetween_weekly_off_sandwhich_rule)||!1,inbetween_holiday_sandwhich_rule:(r==null?void 0:r.inbetween_holiday_sandwhich_rule)||!1},validationSchema:be,onSubmit:async l=>{l.leave_application_after!=3&&delete l.custom_leave_application_date;let m;w?m=await Se(w,l):m=await Ae(l),(m.status===201||m.status===200)&&(d(),U.success(m.message),j.current.refreshListData())},enableReinitialize:!0}),t=()=>{f(l=>l+1)},Y=[{label:"Previous",onClick:()=>{f(l=>l-1)},variant:"secondary",className:"min-w-[90px]",visible:s>1},{label:"Next",onClick:t,className:"min-w-[90px]",visible:s<n},{label:w?"Update":"Add",onClick:a.handleSubmit,className:"min-w-[90px]",visible:s===n,loading:a.isSubmitting}],d=()=>{f(1),E(G("")),a.resetForm(),F(null),x(!1)};return u.useEffect(()=>{p&&_()},[p]),u.useEffect(()=>{p&&w&&y(w)},[p,w]),e.jsx(Z,{header:`${w?"Update":"Add"} Leave Type`,visible:p,onHide:d,progressValue:s/n,formikInstance:a,actions:Y,children:e.jsxs("div",{className:"m-auto grid w-full grid-cols-1 gap-3 md:grid-cols-2",children:[s===1&&e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"md:col-span-2",htmlFor:"leave_type_name",required:!0,title:"Leave Type Name",showError:a.errors.leave_type_name&&a.touched.leave_type_name,errorMessages:a.errors.leave_type_name,children:e.jsx(C,{name:"leave_type_name",value:a.values.leave_type_name,className:h("w-full",{"p-invalid text-red-500":a.errors.leave_type_name&&a.touched.leave_type_name}),onChange:l=>a.setFieldValue("leave_type_name",l.target.value)})}),e.jsxs("div",{className:"col-span-2 m-0 grid grid-cols-2 gap-3",children:[e.jsx("h6",{className:"col-span-2 text-lg font-thin",children:"Application Rules"}),e.jsx(i,{title:"Allow Negative Balance",children:e.jsx(v,{name:"negative_balance",checked:a.values.negative_balance,onChange:l=>{a.setFieldValue("negative_balance",l.value),l.value?a.setFieldValue("max_leave_allowed_in_negative_balance",5):a.setFieldValue("max_leave_allowed_in_negative_balance",0)}})}),a.values.negative_balance&&e.jsx(i,{htmlFor:"max_leave_allowed_in_negative_balance",required:!0,title:"Maximum days allowed in negative balance",showError:a.errors.max_leave_allowed_in_negative_balance&&a.touched.max_leave_allowed_in_negative_balance,errorMessages:a.errors.max_leave_allowed_in_negative_balance,children:e.jsx(q,{min:1,maxLength:2,name:"max_leave_allowed_in_negative_balance",value:a.values.max_leave_allowed_in_negative_balance,className:h("w-full",{"p-invalid text-red-500":a.errors.max_leave_allowed_in_negative_balance&&a.touched.max_leave_allowed_in_negative_balance}),onValueChange:l=>a.setFieldValue("max_leave_allowed_in_negative_balance",l.value)})})]}),e.jsx(i,{htmlFor:"max_days_per_leave",required:!0,title:"Maximum days per leave requests",showError:a.errors.max_days_per_leave&&a.touched.max_days_per_leave,errorMessages:a.errors.max_days_per_leave,children:e.jsx(q,{min:1,maxLength:3,name:"max_days_per_leave",value:a.values.max_days_per_leave,className:h("w-full",{"p-invalid text-red-500":a.errors.max_days_per_leave&&a.touched.max_days_per_leave}),onValueChange:l=>a.setFieldValue("max_days_per_leave",l.value)})}),e.jsx(i,{htmlFor:"max_days_per_month",required:!0,title:"Maximum days per month",showError:a.errors.max_days_per_month&&a.touched.max_days_per_month,errorMessages:a.errors.max_days_per_month,children:e.jsx(q,{min:1,maxLength:2,name:"max_days_per_month",value:a.values.max_days_per_month,className:h("w-full",{"p-invalid text-red-500":a.errors.max_days_per_month&&a.touched.max_days_per_month}),onValueChange:l=>a.setFieldValue("max_days_per_month",l.value)})}),e.jsx(i,{className:"md:col-span-2",title:"Allow half-days for leave application",children:e.jsx(v,{name:"allow_half_days",checked:a.values.allow_half_days,onChange:l=>a.setFieldValue("allow_half_days",l.value)})}),e.jsx(i,{className:h({"md:col-span-2":a.values.leave_application_after!=3}),title:"Allow leave application after",children:e.jsx(V,{options:k,optionLabel:"name",optionValue:"id",value:a.values.leave_application_after,onChange:l=>{a.setFieldValue("leave_application_after",l.value),l.value!=3?a.setFieldValue("custom_leave_application_date",""):a.setFieldValue("custom_leave_application_date",B().format("YYYY-MM-DD"))}})}),a.values.leave_application_after===3&&e.jsx(i,{required:!0,title:"Custom date",showError:a.errors.custom_leave_application_date&&a.touched.custom_leave_application_date,errorMessages:a.errors.custom_leave_application_date,children:e.jsx(ie,{readOnlyInput:!0,dateFormat:"dd-mm-yy",value:B(a.values.custom_leave_application_date,"YYYY-MM-DD").toDate(),className:h("w-full",{"p-invalid text-red-500":a.errors.custom_leave_application_date&&a.touched.custom_leave_application_date}),onChange:l=>a.setFieldValue("custom_leave_application_date",B(l.value).format("YYYY-MM-DD"))})}),e.jsx(i,{title:"Enable leave application on hoildays",children:e.jsx(v,{name:"application_on_holidays",checked:a.values.application_on_holidays,onChange:l=>a.setFieldValue("application_on_holidays",l.value)})})]}),s===2&&e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"md:col-span-2",title:"Enable restriction for leave application",children:e.jsx(v,{name:"restriction_for_application",checked:a.values.restriction_for_application,onChange:l=>{a.setFieldValue("restriction_for_application",l.value),l.value?(a.setFieldValue("limit_back_dated_application",5),a.setFieldValue("notice_for_application",2)):(a.setFieldValue("limit_back_dated_application",0),a.setFieldValue("notice_for_application",0))}})}),a.values.restriction_for_application&&e.jsxs(e.Fragment,{children:[e.jsx(i,{htmlFor:"limit_back_dated_application",required:!0,title:"Set limit for back-dated application (In days)",showError:a.errors.limit_back_dated_application&&a.touched.limit_back_dated_application,errorMessages:a.errors.limit_back_dated_application,children:e.jsx(q,{min:1,maxLength:3,name:"limit_back_dated_application",value:a.values.limit_back_dated_application,className:h("w-full",{"p-invalid text-red-500":a.errors.limit_back_dated_application&&a.touched.limit_back_dated_application}),onValueChange:l=>a.setFieldValue("limit_back_dated_application",l.value)})}),e.jsx(i,{htmlFor:"notice_for_application",required:!0,title:"Set minimum days of notice for leave application (In days)",showError:a.errors.notice_for_application&&a.touched.notice_for_application,errorMessages:a.errors.notice_for_application,children:e.jsx(q,{min:1,maxLength:3,name:"notice_for_application",value:a.values.notice_for_application,className:h("w-full",{"p-invalid text-red-500":a.errors.notice_for_application&&a.touched.notice_for_application}),onValueChange:l=>a.setFieldValue("notice_for_application",l.value)})})]}),e.jsx(i,{className:"md:col-span-2",title:"Enable-Auto approval",children:e.jsx(v,{name:"auto_approval",checked:a.values.auto_approval,onChange:l=>{a.setFieldValue("auto_approval",l.value),l.value?a.setFieldValue("auto_action_after",5):a.setFieldValue("auto_action_after",0)}})}),a.values.auto_approval&&e.jsxs(e.Fragment,{children:[e.jsx(i,{htmlFor:"auto_action_after",required:!0,title:"Auto Action After (in Days)",showError:a.errors.auto_action_after&&a.touched.auto_action_after,errorMessages:a.errors.auto_action_after,children:e.jsx(q,{min:1,maxLength:3,name:"auto_action_after",value:a.values.auto_action_after,className:h("w-full",{"p-invalid text-red-500":a.errors.auto_action_after&&a.touched.auto_action_after}),onValueChange:l=>a.setFieldValue("auto_action_after",l.value)})}),e.jsx(i,{required:!0,title:"Auto Approval Action",children:e.jsx(V,{options:N.filter(l=>l.id!=1),optionLabel:"name",optionValue:"id",value:a.values.auto_approval_action,onChange:l=>a.setFieldValue("auto_approval_action",l.value)})})]}),e.jsx(i,{className:"md:col-span-2",title:"Supporting Document Manadatory",children:e.jsx(v,{name:"supporting_document_mandatory",checked:a.values.supporting_document_mandatory,onChange:l=>a.setFieldValue("supporting_document_mandatory",l.value)})})]}),s===3&&e.jsxs(e.Fragment,{children:[e.jsx(i,{className:"md:col-span-2",title:"Enable prorated accrual for first month",children:e.jsx(v,{name:"prorated_accrual_first_month",checked:a.values.prorated_accrual_first_month,onChange:l=>{a.setFieldValue("prorated_accrual_first_month",l.value),a.setFieldValue("prorated_rounding_factor",0)}})}),a.values.prorated_accrual_first_month&&e.jsxs(e.Fragment,{children:[e.jsx(i,{title:"Rounding",children:e.jsx(V,{options:b,optionLabel:"name",optionValue:"id",value:a.values.prorated_rounding,onChange:l=>a.setFieldValue("prorated_rounding",l.value)})}),e.jsx(i,{htmlFor:"prorated_rounding_factor",title:"Rounding Factor",showError:a.errors.prorated_rounding_factor&&a.touched.prorated_rounding_factor,errorMessages:a.errors.prorated_rounding_factor,children:e.jsx(C,{name:"prorated_rounding_factor",type:"number",value:a.values.prorated_rounding_factor,className:h("w-full",{"p-invalid text-red-500":a.errors.prorated_rounding_factor&&a.touched.prorated_rounding_factor}),onChange:l=>a.setFieldValue("prorated_rounding_factor",l.target.value)})})]}),e.jsx("h6",{className:"col-span-2 text-lg font-thin",children:"Balance Encashment / Carry Forward Rules"}),e.jsx(i,{title:"Allow encashment yearly",children:e.jsx(v,{name:"encashment_yearly",checked:a.values.encashment_yearly,onChange:l=>{a.setFieldValue("encashment_yearly",l.value),l.value?a.setFieldValue("max_leaves_for_encashment",5):a.setFieldValue("max_leaves_for_encashment",0)}})}),a.values.encashment_yearly&&e.jsx(i,{htmlFor:"max_leaves_for_encashment",title:"Maximum leaves for encashment",showError:a.errors.max_leaves_for_encashment&&a.touched.max_leaves_for_encashment,errorMessages:a.errors.max_leaves_for_encashment,children:e.jsx(q,{min:1,maxLength:3,name:"max_leaves_for_encashment",value:a.values.max_leaves_for_encashment,className:h("w-full",{"p-invalid text-red-500":a.errors.max_leaves_for_encashment&&a.touched.max_leaves_for_encashment}),onValueChange:l=>a.setFieldValue("max_leaves_for_encashment",l.value)})}),e.jsx(i,{className:"col-span-2",title:"Allow carry forward yearly",children:e.jsx(v,{name:"carry_forward_yearly",checked:a.values.carry_forward_yearly,onChange:l=>{a.setFieldValue("carry_forward_yearly",l.value),a.setFieldValue("carry_forward_rounding_factor",0)}})}),a.values.carry_forward_yearly&&e.jsxs(e.Fragment,{children:[e.jsx(i,{title:"Rounding",children:e.jsx(V,{options:b,optionLabel:"name",optionValue:"id",value:a.values.carry_forward_rounding,onChange:l=>a.setFieldValue("carry_forward_rounding",l.value)})}),e.jsx(i,{htmlFor:"carry_forward_rounding_factor",title:"Rounding Factor",showError:a.errors.carry_forward_rounding_factor&&a.touched.carry_forward_rounding_factor,errorMessages:a.errors.carry_forward_rounding_factor,children:e.jsx(C,{name:"carry_forward_rounding_factor",type:"number",value:a.values.carry_forward_rounding_factor,className:h("w-full",{"p-invalid text-red-500":a.errors.carry_forward_rounding_factor&&a.touched.carry_forward_rounding_factor}),onChange:l=>a.setFieldValue("carry_forward_rounding_factor",l.target.value)})})]}),e.jsx(i,{className:"md:col-span-2",title:"Allow intra cycle carry forward",children:e.jsx(v,{name:"intra_cycle_carry_forward",checked:a.values.intra_cycle_carry_forward,onChange:l=>a.setFieldValue("intra_cycle_carry_forward",l.value)})})]}),s===4&&e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:"col-span-2 text-lg font-thin",children:"Prefix, Postfix and Sandwich Leave Rules"}),e.jsxs(i,{className:"md:col-span-2",title:"Additional days to be included PRIOR to the leave start date and post the leave end date",children:[e.jsx(i,{inlineEnd:!0,title:"Include Weekly-off",children:e.jsx(S,{className:"self-center",name:"prefix_postFix_sandwhich_rules",inputId:"prefix_postfix_weekly_off_sandwhich_rule",onChange:l=>a.setFieldValue("prefix_postfix_weekly_off_sandwhich_rule",l.checked),checked:a.values.prefix_postfix_weekly_off_sandwhich_rule})}),e.jsx(i,{inlineEnd:!0,title:"Include holiday",children:e.jsx(S,{className:"self-center",name:"prefix_postFix_sandwhich_rules",inputId:"prefix_postfix_holiday_sandwhich_rule",onChange:l=>a.setFieldValue("prefix_postfix_holiday_sandwhich_rule",l.checked),checked:a.values.prefix_postfix_holiday_sandwhich_rule})})]}),e.jsxs(i,{className:"md:col-span-2",title:"Additional days to be included In-Between the leave start and end date ",children:[e.jsx(i,{inlineEnd:!0,title:"Include Weekly-off",children:e.jsx(S,{className:"self-center",name:"inbetween_sandwhich_rules",inputId:"inbetween_weekly_off_sandwhich_rule",onChange:l=>a.setFieldValue("inbetween_weekly_off_sandwhich_rule",l.checked),checked:a.values.inbetween_weekly_off_sandwhich_rule})}),e.jsx(i,{inlineEnd:!0,title:"Include holiday",children:e.jsx(S,{className:"self-center",name:"inbetween_sandwhich_rules",inputId:"inbetween_holiday_sandwhich_rule",onChange:l=>a.setFieldValue("inbetween_holiday_sandwhich_rule",l.checked),checked:a.values.inbetween_holiday_sandwhich_rule})})]})]})]})})},Ke=({visible:p,onHide:x,tableRef:j})=>{const E=W(),n=L(Q),g=L(ve),[s,f]=u.useState(!1),[r]=u.useState(B().format("YYYY-MM-DD")),[F,w]=u.useState([]),[k,M]=u.useState([]),[N,c]=u.useState([]),[b,A]=u.useState([]),_=async()=>{const d=await Be(),l=await Ye(),m=await oe(),I=await ne();w(d.status===200?d.data.data:[]),M(l.status===200?l.data.data:[]),c(m.status===200?m.data.data:[]),A(I.status===200?I.data.data:[])},y=async d=>{const l=await Pe(d);l.data.status===200?f(l.data.data):f(null)},a=d=>{const l={};if(!d||(d==null?void 0:d.length)===0)for(let m of b)l[m.id]=0;else for(let m of d)l[m.month_number]=m.allocated_leaves;return l},t=X({initialValues:{leave_type_id:n,leave_policy_name:(s==null?void 0:s.leave_policy_name)||"",description:(s==null?void 0:s.description)||"",accrual_frequency:(s==null?void 0:s.accrual_frequency)||4,accrual_type:(s==null?void 0:s.accrual_type)||1,accrual_from:(s==null?void 0:s.accrual_from)||2,custom_leave_application_date:(s==null?void 0:s.custom_leave_application_date)||r,advance_accrual_for_entire_leave_year:(s==null?void 0:s.advance_accrual_for_entire_leave_year)||!1,annual_eligibility:(s==null?void 0:s.annual_eligibility)||0,annual_breakup:(s==null?void 0:s.annual_breakup)||!1,custom_annual_breakup:a(s==null?void 0:s.leaveAllocations)},validationSchema:Fe,onSubmit:async d=>{let l;g?l=await qe(g,d):l=await Re(d),(l.status===201||l.status===200)&&(Y(),U.success(l.message),j.current.refreshListData())},enableReinitialize:!0}),$=[{label:g?"Update":"Add",onClick:t.handleSubmit,className:"min-w-[90px]",loading:t.isSubmitting}],Y=()=>{E(se("")),t.resetForm(),f(null),x(!1)};return u.useEffect(()=>{p&&_()},[p]),u.useEffect(()=>{p&&g&&y(g)},[p,g]),e.jsx(Z,{header:`${g?"Update":"Add"} Leave Type Policy`,visible:p,onHide:Y,actions:$,children:e.jsxs("div",{className:"m-auto grid w-full gap-3 md:grid-cols-2",children:[e.jsx(i,{htmlFor:"leave_policy_name",required:!0,title:"Leave Policy name",showError:t.errors.leave_policy_name&&t.touched.leave_policy_name,errorMessages:t.errors.leave_policy_name,children:e.jsx(C,{name:"leave_policy_name",value:t.values.leave_policy_name,className:h("w-full",{"p-invalid text-red-500":t.errors.leave_policy_name&&t.touched.leave_policy_name}),onChange:d=>t.setFieldValue("leave_policy_name",d.target.value)})}),e.jsx(i,{htmlFor:"description",required:!0,title:"Description",showError:t.errors.description&&t.touched.description,errorMessages:t.errors.description,children:e.jsx(C,{name:"description",value:t.values.description,className:h("w-full",{"p-invalid text-red-500":t.errors.description&&t.touched.description}),onChange:d=>t.setFieldValue("description",d.target.value)})}),e.jsx("h6",{className:"col-span-2 text-lg font-thin",children:"Accrual Rules"}),e.jsx(i,{title:"Accrual Frequency",children:e.jsx(V,{options:F,optionLabel:"name",optionValue:"id",value:t.values.accrual_frequency,onChange:d=>{t.setFieldValue("accrual_frequency",d.value),t.setFieldValue("accrual_type",1)}})}),e.jsx(i,{title:"Accrual Type",children:e.jsx(V,{options:t.values.accrual_frequency===1?k.filter(d=>d.id!=2):k,optionLabel:"name",optionValue:"id",value:t.values.accrual_type,onChange:d=>t.setFieldValue("accrual_type",d.value)})}),e.jsx(i,{className:h({"md:col-span-2":t.values.accrual_from!=3}),title:"Accrual From",children:e.jsx(V,{options:N,optionLabel:"name",optionValue:"id",value:t.values.accrual_from,onChange:d=>t.setFieldValue("accrual_from",d.value)})}),t.values.accrual_from===3&&e.jsx(i,{required:!0,title:"Custom date",showError:t.errors.custom_leave_application_date&&t.touched.custom_leave_application_date,errorMessages:t.errors.custom_leave_application_date,children:e.jsx(ie,{readOnlyInput:!0,value:B(t.values.custom_leave_application_date,"YYYY-MM-DD").toDate(),className:h("w-full",{"p-invalid text-red-500":t.errors.custom_leave_application_date&&t.touched.custom_leave_application_date}),onChange:d=>t.setFieldValue("custom_leave_application_date",B(d.value).format("YYYY-MM-DD"))})}),e.jsx(i,{htmlFor:"annual_eligibility",required:!0,title:"Annual Eligibility",showError:t.errors.annual_eligibility&&t.touched.annual_eligibility,errorMessages:t.errors.annual_eligibility,children:e.jsx(C,{name:"annual_eligibility",type:"number",min:1,value:t.values.annual_eligibility,className:h("w-full",{"p-invalid text-red-500":t.errors.annual_eligibility&&t.touched.annual_eligibility}),onChange:d=>t.setFieldValue("annual_eligibility",d.target.value)})}),e.jsx(i,{title:"Allow Advance Accrual For Entire Leave Calendar Year",children:e.jsx(v,{name:"advance_accrual_for_entire_leave_year",disabled:t.values.annual_breakup,checked:t.values.advance_accrual_for_entire_leave_year,onChange:d=>t.setFieldValue("advance_accrual_for_entire_leave_year",d.value)})}),e.jsx(i,{className:"md:col-span-2",title:"Annual Break-up",children:e.jsx(v,{name:"annual_breakup",disabled:t.values.advance_accrual_for_entire_leave_year,checked:t.values.annual_breakup,onChange:d=>{t.setFieldValue("annual_breakup",d.value),d.checked&&t.setFieldValue("advance_accrual_for_entire_leave_year",!1)}})}),t.values.annual_breakup&&e.jsxs("div",{className:"m-0 grid grid-cols-4 gap-3",children:[t.errors.custom_annual_breakup&&t.touched.custom_annual_breakup&&e.jsx("div",{className:"col-span-4 text-xs text-red-500",children:t.errors.custom_annual_breakup}),b.length>0&&t.values.custom_annual_breakup&&b.map((d,l)=>e.jsxs("div",{className:"!text-center",children:[l+1,e.jsx(C,{className:"text-center",type:"number",value:t.values.custom_annual_breakup[d.id],onChange:m=>t.setFieldValue("custom_annual_breakup",{...t.values.custom_annual_breakup,[d.id]:m.target.value})})]},`month_${d.id}`))]})]})})},fa=()=>{const p=W(),x=u.useRef(null),j=u.useRef(null),E=L(Q),[n,g]=u.useState(0),[s,f]=u.useState(""),[r,F]=u.useState(null),[w,k]=u.useState(!1),[M,N]=u.useState(!1),[c,b]=u.useState(!1),[A,_]=u.useState(!1),y=[{id:1,label:"Leave Configuration",addButtonHeading:"Add Leave Configuration"},{id:2,label:"Leave Types",addButtonHeading:"Add Leave Type"}],a=async o=>await Oe({filterBy:"search_term",filterValue:s,page:o.page+1,records:o.rows,sortBy:o.sortField?o.sortField:"",sortOrder:o.sortField?o.sortOrder===-1?"DESC":"ASC":""}),t=async o=>await Le({filterBy:"search_term",filterValue:s,page:o.page+1,records:o.rows,sortBy:o.sortField?o.sortField:"",sortOrder:o.sortField?o.sortOrder===-1?"DESC":"ASC":""}),$=async o=>await He({leaveTypeId:E,filterBy:"search_term",filterValue:s,page:o.page+1,records:o.rows,sortBy:o.sortField?o.sortField:"",sortOrder:o.sortField?o.sortOrder===-1?"DESC":"ASC":""}),Y=o=>e.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:J,onClick:()=>T(o)}),e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:K,onClick:()=>z(o)})]}),d=o=>{const P=o.leave_type_policies?o.leave_type_policies.map(H=>H.leave_policy_name):[];return P.length>0?P.join(", "):"N/A"},l=o=>e.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:ye,onClick:()=>pe(o)}),e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:J,onClick:()=>T(o)}),e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:K,onClick:()=>z(o)})]}),m=o=>e.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:J,onClick:()=>D(o)}),e.jsx("img",{className:"cursor-pointer",width:25,height:25,src:K,onClick:()=>he(o)})]}),I=[{field:"policy_name",header:"Leave Configuration Name",sortable:!0},{field:"policy_description",header:"Description"},{align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:Y}],ce=[{field:"leave_type_name",header:"Leave Type Name",sortable:!0},{field:"leave_type_policies",header:"Description",body:d},{align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:l}],de=[{field:"leave_policy_name",header:"Leave Type Policy Name",sortable:!0},{field:"description",header:"Description"},{align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:m}],_e=()=>{if(n===0)return a;if(n===1)return t},ue=()=>{if(n===0)return I;if(n===1)return ce},pe=o=>{f(""),p(G(o.id)),F(o.leave_type_name),k(!0)},T=o=>{n===0&&(p(te(o.id)),N(!0)),n===1&&(p(G(o.id)),b(!0))},z=o=>{const P=async H=>{let R;n===0&&(R=await Ue(H)),n===1&&(R=await $e(H)),R.status===200&&(U.success(R.message),x.current.refreshListData())};return ee({draggable:!1,resizable:!1,message:"Do you want to delete this policy?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>P(o.id),reject:()=>{}})},me=()=>{n===0?N(!0):b(!0)},D=o=>{o&&p(se(o.id)),_(!0)},he=o=>{const P=async H=>{const R=await Ge(H);R.status===200&&(U.success(R.message),j.current.refreshListData())};return ee({draggable:!1,resizable:!1,message:"Do you want to delete this leave type policy?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>P(o.id),reject:()=>{}})};return e.jsxs("div",{className:"flex w-full flex-col",children:[!w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Leaves"}),e.jsxs(ae,{className:"flex w-full flex-col",children:[e.jsx(we,{activeIndex:n,onTabChange:o=>{f(""),g(o.index),x.current.loadFirstPage()},model:y}),e.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[e.jsx(C,{placeholder:"Search policy name",value:s,onChange:o=>f(o.target.value)}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(O,{icon:"pi pi-times",severity:"danger",onClick:()=>{f(""),x.current&&x.current.refreshListData()}}),e.jsx(O,{icon:"pi pi-search",disabled:!s,onClick:()=>{x.current&&x.current.refreshListData()}})]})]}),e.jsx(O,{raised:!0,label:y.filter(o=>o.id===n+1)[0].addButtonHeading,icon:e.jsx("img",{src:re}),onClick:me})]}),e.jsx(le,{ref:x,dataHandler:_e(),id:"leave_policies_module",headers:ue()})]})]}),w&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-max gap-2 border-none px-0 !font-extralight !text-black shadow-none",icon:e.jsx("img",{src:ge}),link:!0,label:"Go Back",onClick:()=>{f(""),p(G("")),F(null),k(!1)}}),e.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:r}),e.jsxs(ae,{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[e.jsx(C,{placeholder:"Search policy name",value:s,onChange:o=>f(o.target.value)}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(O,{icon:"pi pi-times",severity:"danger",onClick:()=>{f(""),j.current&&j.current.refreshListData()}}),e.jsx(O,{icon:"pi pi-search",disabled:!s,onClick:()=>{j.current&&j.current.refreshListData()}})]})]}),e.jsx(O,{raised:!0,label:"Add Leave Policy",icon:e.jsx("img",{src:re}),onClick:D})]}),e.jsx(le,{ref:j,dataHandler:$,id:"attendance_policies",headers:de})]})]}),e.jsx(We,{visible:M,onHide:()=>N(!1),tableRef:x}),e.jsx(Je,{visible:c,onHide:()=>b(!1),tableRef:x}),e.jsx(Ke,{visible:A,onHide:()=>_(!1),tableRef:j})]})};export{fa as default};
