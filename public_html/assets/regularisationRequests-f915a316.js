import{r as l,G as o,j as r,af as _,$ as R}from"./index-3ec7abe5.js";import{C as S,D as j}from"./dropdown.esm-1ad10373.js";import{T as E}from"./index-b2a6305f.js";import{b as $,c as T,d as k,e as L}from"./api-9fc8da4c.js";import{C as p}from"./index-3d6f48ca.js";import{I as z}from"./inputtext.esm-e49a03d7.js";import{C as H}from"./calendar.esm-f987a87a.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./index.esm-be3d6ae7.js";const P=()=>{const t=l.useRef(null),[d,b]=l.useState(o().toDate()),[c,h]=l.useState(""),[n,m]=l.useState(""),[w,g]=l.useState([]),q=async()=>{const e=await $();e.status===200?g(e.data.data):g([])},y=async e=>await T({month:d?o(d).month()+1:"",year:d?o(d).year():"",filterBy:c,filterValue:n,page:e.page+1,records:e.rows,sortBy:e.sortField?e.sortField:"",sortOrder:e.sortField?e.sortOrder===-1?"DESC":"ASC":""}),N=e=>!(e!=null&&e.recorded_in_time)&&!(e!=null&&e.recorded_out_time)?"---":!(e!=null&&e.recorded_in_time)&&(e!=null&&e.recorded_out_time)?`N/A - ${o(e==null?void 0:e.recorded_out_time,"HH:mm:ss").format("hh:mm A")}`:e!=null&&e.recorded_in_time&&!(e!=null&&e.recorded_out_time)?`${o(e==null?void 0:e.recorded_in_time,"HH:mm:ss").format("hh:mm A")} - N/A`:`${o(e==null?void 0:e.recorded_in_time).format("hh:mm A")} - ${o(e==null?void 0:e.recorded_out_time).format("hh:mm A")}`,D=e=>{var s,a;return`${o((s=e==null?void 0:e.regularization_record)==null?void 0:s.in_time).format("hh:mm A")} - ${o((a=e==null?void 0:e.regularization_record)==null?void 0:a.out_time).format("hh:mm A")}`},x=e=>{if(e==1)return"F44336";if(e==2)return"BDED16";if(e==3)return"4CAF50";if(e==4)return"D9DDE2"},C=e=>{var a,i;const s=async u=>{const f=await k(u);f.status===200&&(R.success(f.message),t.current.refreshListData())};return _({draggable:!1,resizable:!1,message:r.jsxs("p",{children:["Approve regularisation request for ",r.jsx("span",{className:"font-bold",children:(i=(a=e==null?void 0:e.regularization_record)==null?void 0:a.Requester)==null?void 0:i.employee_name}),"?"]}),header:"Approval Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-success",rejectClassName:"p-button-link mr-2",accept:()=>s(e.id),reject:()=>{}})},A=e=>{var a,i;const s=async u=>{const f=await L(u);f.status===200&&(R.success(f.message),t.current.refreshListData())};return _({draggable:!1,resizable:!1,message:r.jsxs("p",{children:["Reject regularisation request for ",r.jsx("span",{className:"font-bold",children:(i=(a=e==null?void 0:e.regularization_record)==null?void 0:a.Requester)==null?void 0:i.employee_name}),"?"]}),header:"Recjection Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>s(e.id),reject:()=>{}})},F=[{field:"employee_name",header:"Requester",sortable:!0,body:e=>{var s,a;return((a=(s=e==null?void 0:e.regularization_record)==null?void 0:s.Requester)==null?void 0:a.employee_name)||"N/A"}},{field:"date",header:"Date",sortable:!0,body:e=>{var s;return o((s=e==null?void 0:e.regularization_record)==null?void 0:s.date).format("ddd, MMM DD, YYYY")}},{field:"recorded_time",header:"Recorded Time",body:N},{field:"requested_time",header:"Requested Time",body:D},{field:"recorded_status",header:"Recorded Status",body:e=>{var s,a;return r.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[r.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${x((s=e==null?void 0:e.recorded_status)==null?void 0:s.id)}]`}),r.jsx("span",{className:"text-sm",children:((a=e==null?void 0:e.recorded_status)==null?void 0:a.name)||"---"})]})}},{field:"request_status",header:"Requested Status",sortable:!0,body:e=>{var s,a,i,u;return r.jsxs("div",{className:"inline-flex items-center justify-center gap-[0.375rem]",children:[r.jsx("div",{className:`h-[0.75rem] w-[0.75rem] rounded-[0.125rem] bg-[#${x((a=(s=e==null?void 0:e.regularization_record)==null?void 0:s.Request_status)==null?void 0:a.id)}]`}),r.jsx("span",{className:"text-sm",children:((u=(i=e==null?void 0:e.regularization_record)==null?void 0:i.Request_status)==null?void 0:u.name)||"---"})]})}},{field:"reason",header:"Reason",body:e=>{var s;return((s=e==null?void 0:e.regularization_record)==null?void 0:s.reason)||"N/A"}},{field:"actions",header:"Actions",alignHeader:"center",body:e=>r.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[r.jsx(p,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Approve",severity:"success",onClick:()=>C(e)}),r.jsx(p,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Reject",severity:"danger",onClick:()=>A(e)})]})}];return l.useEffect(()=>{q()},[]),l.useEffect(()=>{t.current&&t.current.refreshListData()},[d]),r.jsxs("div",{className:"flex w-full flex-col",children:[r.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Regularisation Requests"}),r.jsxs(S,{className:"flex w-full flex-col",children:[r.jsx("div",{className:"my-2 flex flex-row justify-between p-3",children:r.jsxs("div",{className:"flex w-full flex-col items-center gap-3 md:flex-row",children:[r.jsx(H,{className:"w-full md:!w-fit",name:"filter_date",readOnlyInput:!0,view:"month",dateFormat:"M yy",placeholder:"Select month",maxDate:o().toDate(),value:d,onChange:e=>{h(""),m(""),b(e.value)}}),c==="search_term"&&r.jsx(z,{className:"w-full md:!w-fit",placeholder:"Search",value:n,onChange:e=>m(e.target.value)}),c==="requested_status"&&r.jsx(j,{placeholder:"Select Status",className:"w-full md:!w-fit",options:w,optionLabel:"name",optionValue:"id",value:n,onChange:e=>{m(e.value)}}),r.jsx(j,{placeholder:"Filter by",className:"w-full md:!w-fit",options:[{label:"Employee Name",code:"search_term"},{label:"Requested Status",code:"requested_status"}],optionLabel:"label",optionValue:"code",value:c,onChange:e=>{m(""),h(e.value)}}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(p,{icon:"pi pi-times",severity:"danger",disabled:!c,onClick:()=>{h(""),m(""),t.current&&t.current.refreshListData()}}),r.jsx(p,{icon:"pi pi-search",disabled:!n||!c,onClick:()=>{t.current&&t.current.refreshListData()}})]})]})}),r.jsx(E,{dataHandler:y,id:"regularisation_requests",headers:F,ref:t})]})]})};export{P as default};
