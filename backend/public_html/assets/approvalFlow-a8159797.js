import{v as k,bP as B,r as o,$ as S,j as r,f as g,bQ as A,af as I}from"./index-3ec7abe5.js";import{D as L,C as M}from"./dropdown.esm-1ad10373.js";import{T}from"./index-b2a6305f.js";import{E as D}from"./edit-c01b3e15.js";import{P as H}from"./plus-b36a0702.js";import{T as O}from"./trash-4a28e917.js";import{C as v}from"./index-3d6f48ca.js";import{u as q,n as $}from"./validationSchemas-9cdf4188.js";import{I as b}from"./inputtext.esm-e49a03d7.js";import{B as P}from"./index-36dd5a0c.js";import{L as d}from"./index-37ade0e2.js";import{M as C}from"./multiselect.esm-15dd71d0.js";import{I as y}from"./inputswitch.esm-65362ee3.js";import{x as K,y as Q,z as U,A as G,B as J,n as W,C as X,D as Y}from"./api-9d9fddec.js";import{u as R}from"./useDispatch-1aeda00f.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";const Z=({visible:c,onHide:l,tableRef:p})=>{const _=R(),n=k(B),[m,h]=o.useState([]),[j,x]=o.useState([]);o.useState([]);const[w,i]=o.useState([]);o.useState([]);const[t,u]=o.useState(null),f=async a=>{const s=await U(a);s.data.status===200?u(s.data.data):u(null)},E=async()=>{const a=await G(),s=await J(),N=await W();h(a.status===200?a.data.data:[]),x(s.status===200?s.data.data:[]),i(N.status===200?N.data.data:[])},F=()=>{_(A("")),u(null),e.resetForm(),l(!1)},e=q({initialValues:{name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",approval_flow_type_id:(t==null?void 0:t.approval_flow_type_id)||1,direct_reporting_manager_id:(t==null?void 0:t.direct.map(a=>a.id))||[],indirect_reporting_manager_id:(t==null?void 0:t.indirect.map(a=>a.id))||[],confirm_by_both_direct_undirect:(t==null?void 0:t.confirm_by_both_direct_undirect)||!1,confirmation_by_all_direct:(t==null?void 0:t.confirmation_by_all_direct)||!1,confirmation_by_all_indirect:(t==null?void 0:t.confirmation_by_all_indirect)||!1},validationSchema:$,onSubmit:async a=>{let s;n?s=await Q(n,a):s=await K(a),(s.status===201||s.status===200)&&(F(),S.success(s.message),p.current.refreshListData())},enableReinitialize:!0}),V=[{label:n?"Update":"Add",onClick:e.handleSubmit,className:"min-w-[90px]",loading:e.isSubmitting}];return o.useEffect(()=>{E()},[]),o.useEffect(()=>{c&&n&&f(n)},[c,n]),r.jsx(P,{header:`${n?"Update":"Add"} Approval Flow`,visible:c,onHide:F,actions:V,children:r.jsxs("div",{className:"m-auto grid w-full gap-3",children:[r.jsx(d,{required:!0,title:"Approval Flow Name",className:"md:col-span-2",showError:e.errors.name&&e.touched.name,errorMessages:e.errors.name,children:r.jsx(b,{name:"name",value:e.values.name,className:g("w-full",{"p-invalid text-red-500":e.errors.name&&e.touched.name}),onChange:a=>e.setFieldValue("name",a.target.value)})}),r.jsx(d,{required:!0,title:"Description",className:"md:col-span-2",showError:e.errors.description&&e.touched.description,errorMessages:e.errors.description,children:r.jsx(b,{name:"description",value:e.values.description,className:g("w-full",{"p-invalid text-red-500":e.errors.description&&e.touched.description}),onChange:a=>e.setFieldValue("description",a.target.value)})}),r.jsx(d,{className:"md:col-span-2",title:"Approval Flow Type",children:r.jsx(L,{inputId:"approval_flow_type_id",options:m,optionLabel:"name",optionValue:"id",value:e.values.approval_flow_type_id,onChange:a=>e.setFieldValue("approval_flow_type_id",a.value)})}),r.jsx(d,{className:"md:col-span-2",required:!0,title:"Direct Reporting Role",showError:e.errors.direct_reporting_manager_id&&e.touched.direct_reporting_manager_id,errorMessages:e.errors.direct_reporting_manager_id,children:r.jsx(C,{dataKey:"id",inputId:"direct_reporting_roles",options:j,filter:!0,resetFilterOnHide:!0,showClear:!0,display:"chip",optionValue:"id",optionLabel:"name",placeholder:"Select Roles",value:e.values.direct_reporting_manager_id,onChange:a=>e.setFieldValue("direct_reporting_manager_id",a.value),className:g("w-full",{"p-invalid text-red-500":e.errors.direct_reporting_manager_id&&e.touched.direct_reporting_manager_id}),pt:{label:{className:"flex !gap-1 flex-wrap mr-3"},token:{className:"w-max max-h-[2rem] !rounded-[0.25rem] !bg-[#37B3E0] !text-white py-1 px-2 text-sm m-0"}}})}),r.jsx(d,{className:"md:col-span-2",title:"Confirmation By All (Direct)",children:r.jsx(y,{name:"confirmation_by_all_direct",checked:e.values.confirmation_by_all_direct,onChange:a=>{e.setFieldValue("confirmation_by_all_direct",a.value)}})}),r.jsx(d,{title:"Confirm by both direct and non direct reporting manager",children:r.jsx(y,{name:"confirm_by_both_direct_undirect",checked:e.values.confirm_by_both_direct_undirect,onChange:a=>{e.setFieldValue("confirm_by_both_direct_undirect",a.value),e.setFieldValue("indirect_reporting_manager_id",[]),e.setFieldValue("confirmation_by_all_indirect",!1)}})}),e.values.confirm_by_both_direct_undirect&&r.jsxs(r.Fragment,{children:[r.jsx(d,{required:!0,className:"md:col-span-2",title:"Indirect Reporting Managers (Supervisors)",showError:e.errors.indirect_reporting_manager_id&&e.touched.indirect_reporting_manager_id,errorMessages:e.errors.indirect_reporting_manager_id,children:r.jsx(C,{inputId:"indirect_reporting_roles",dataKey:"id",options:w,showClear:!0,filter:!0,resetFilterOnHide:!0,display:"chip",optionValue:"id",optionLabel:a=>`${a.employee_name} (${a.employee_generated_id})`,placeholder:"Select Supervisors",value:e.values.indirect_reporting_manager_id,onChange:a=>e.setFieldValue("indirect_reporting_manager_id",a.value),className:g("w-full",{"p-invalid text-red-500":e.errors.indirect_reporting_manager_id&&e.touched.indirect_reporting_manager_id}),pt:{label:{className:"flex !gap-1 flex-wrap mr-3"},token:{className:"w-max max-h-[2rem] !rounded-[0.25rem] !bg-[#37B3E0] !text-white py-1 px-2 text-sm m-0"}}})}),r.jsx(d,{className:"md:col-span-2",title:"Confirmation By All (Indirect)",children:r.jsx(y,{name:"confirmation_by_all_indirect",checked:e.values.confirmation_by_all_indirect,onChange:a=>{e.setFieldValue("confirmation_by_all_indirect",a.value)}})})]})]})})},ge=()=>{const c=R(),l=o.useRef(null),[p,_]=o.useState(""),[n,m]=o.useState(!1),h=async i=>await X({filterBy:"search_term",filterValue:p,page:i.page+1,records:i.rows,sortBy:i.sortField?i.sortField:"",sortOrder:i.sortField?i.sortOrder===-1?"DESC":"ASC":""}),x=[{field:"flow_name",header:"Flow Name",sortable:!0,body:i=>i.name},{field:"description",header:"Description"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:i=>r.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:D,onClick:()=>{c(A(i.id)),m(!0)}}),r.jsx("img",{className:"cursor-pointer",width:25,height:25,src:O,onClick:()=>w(i)})]})}],w=i=>{const t=async u=>{const f=await Y(u);f.status===200&&(S.success(f.message),l.current.refreshListData())};return I({draggable:!1,resizable:!1,message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>t(i.id),reject:()=>{}})};return r.jsxs("div",{className:"flex w-full flex-col",children:[r.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Approval Flow"}),r.jsxs(M,{className:"flex w-full flex-col",children:[r.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[r.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[r.jsx(b,{placeholder:"Search flow name",value:p,onChange:i=>_(i.target.value)}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(v,{icon:"pi pi-times",severity:"danger",onClick:()=>{_(""),l.current&&l.current.refreshListData()}}),r.jsx(v,{icon:"pi pi-search",disabled:!p,onClick:()=>{l.current&&l.current.refreshListData()}})]})]}),r.jsx(v,{raised:!0,label:"Add Approval Flow",icon:r.jsx("img",{src:H}),onClick:()=>m(!0)})]}),r.jsx(T,{dataHandler:h,id:"approval_flows",headers:x,ref:l})]}),r.jsx(Z,{visible:n,onHide:()=>m(!1),tableRef:l})]})};export{ge as default};
