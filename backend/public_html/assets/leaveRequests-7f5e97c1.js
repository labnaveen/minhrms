import{$ as g,j as s,f as T,r as i,G as m,af as M}from"./index-3ec7abe5.js";import{C as k,D as _}from"./dropdown.esm-1ad10373.js";import{T as S}from"./index-b2a6305f.js";import{h as q,i as A,j as E,k as Y}from"./api-9fc8da4c.js";import{C as y}from"./index-3d6f48ca.js";import{I as B}from"./inputtext.esm-e49a03d7.js";import{C as V}from"./calendar.esm-f987a87a.js";import{B as H}from"./index-36dd5a0c.js";import{u as I,c as O}from"./validationSchemas-9cdf4188.js";import{I as W}from"./inputtextarea.esm-51dfddb5.js";import{L as G}from"./index-37ade0e2.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./index.esm-be3d6ae7.js";const P=({visible:t,onHide:c,tableRef:x,leaveRequestData:a})=>{var f,p;const o=I({initialValues:{reject_reason:""},validationSchema:O(a==null?void 0:a.rejection_reason_mandatory),onSubmit:async u=>{const h=await q(a.id,u);h.status===200&&(n(),g.success(h.message),x.current.refreshListData())},enableReinitialize:!0}),n=()=>{c()},d=[{label:"No",onClick:n,className:"px-3 py-2 w-fit p-button-link"},{label:"Yes",severity:"danger",loading:o.isSubmitting,onClick:o.handleSubmit,className:"px-3 py-2 w-fit"}];return s.jsx(H,{className:"md:w-[30%]",header:"Rejection Confirmation",visible:t,onHide:n,actions:d,children:s.jsxs("div",{className:"flex w-full flex-col gap-3",children:[s.jsxs("p",{children:["Reject leave request for ",s.jsx("span",{className:"font-bold",children:(p=(f=a==null?void 0:a.leave_record)==null?void 0:f.requester)==null?void 0:p.employee_name}),"?"]}),s.jsx(G,{required:a==null?void 0:a.rejection_reason_mandatory,title:"Reason",htmlFor:"reject_reason",showError:o.errors.reject_reason&&o.touched.reject_reason,errorMessages:o.errors.reject_reason,children:s.jsx(W,{name:"reject_reason",rows:2,autoResize:!0,className:T("w-full",{"p-invalid text-red-500":o.errors.reject_reason&&o.touched.reject_reason}),onChange:u=>{o.setFieldValue("reject_reason",u.target.value)}})})]})})},le=()=>{const t=i.useRef(null),[c,x]=i.useState(m().toDate()),[a,o]=i.useState(""),[n,d]=i.useState(""),[f,p]=i.useState([]),[u,h]=i.useState(null),[N,j]=i.useState(!1),C=async()=>{const e=await A();e.status===200?p(e.data.data):p([])},L=async e=>await E({month:c?m(c).month()+1:"",year:c?m(c).year():"",filterBy:a,filterValue:n,page:e.page+1,records:e.rows,sortBy:e.sortField?e.sortField:"",sortOrder:e.sortField?e.sortOrder===-1?"DESC":"ASC":""}),R=e=>{var l,b;const r=async D=>{const w=await Y(D);w.status===200&&(g.success(w.message),t.current.refreshListData())};return M({draggable:!1,resizable:!1,message:s.jsxs("p",{children:["Approve leave request for ",s.jsx("span",{className:"font-bold",children:(b=(l=e==null?void 0:e.leave_record)==null?void 0:l.requester)==null?void 0:b.employee_name}),"?"]}),header:"Approval Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-success",rejectClassName:"p-button-link mr-2",accept:()=>r(e.id),reject:()=>{}})},v=e=>{h(e),j(!0)},F=[{field:"employee_name",header:"Requester",sortable:!0,body:e=>{var r,l;return((l=(r=e==null?void 0:e.leave_record)==null?void 0:r.requester)==null?void 0:l.employee_name)||"N/A"}},{field:"leave_type",header:"Leave Type",sortable:!0,body:e=>{var r,l;return((l=(r=e==null?void 0:e.leave_record)==null?void 0:r.leave_type)==null?void 0:l.leave_type_name)||"N/A"}},{field:"day_type",header:"Day Type",sortable:!0,body:e=>{var r,l;return((l=(r=e==null?void 0:e.leave_record)==null?void 0:r.day_type)==null?void 0:l.name)||"N/A"}},{field:"from",header:"From",sortable:!0,body:e=>{var r;return m((r=e==null?void 0:e.leave_record)==null?void 0:r.start_date).format("ddd, MMM DD, YYYY")}},{field:"to",header:"To",sortable:!0,body:e=>{var r;return m((r=e==null?void 0:e.leave_record)==null?void 0:r.end_date).format("ddd, MMM DD, YYYY")}},{field:"reason",header:"Reason",body:e=>{var r;return((r=e==null?void 0:e.leave_record)==null?void 0:r.reason)||"N/A"}},{field:"actions",header:"Actions",alignHeader:"center",body:e=>s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row",children:[s.jsx(y,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Approve",severity:"success",onClick:()=>R(e)}),s.jsx(y,{className:"w-full text-sm hover:scale-110 md:w-fit",outlined:!0,label:"Reject",severity:"danger",onClick:()=>v(e)})]})}];return i.useEffect(()=>{C()},[]),i.useEffect(()=>{t.current&&t.current.refreshListData()},[c]),s.jsxs("div",{className:"flex w-full flex-col",children:[s.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Leave Requests"}),s.jsxs(k,{className:"flex w-full flex-col",children:[s.jsx("div",{className:"my-2 flex flex-col justify-between p-3 md:flex-row",children:s.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[s.jsx(V,{className:"w-full md:!w-fit",name:"filter_date",readOnlyInput:!0,view:"month",dateFormat:"M yy",placeholder:"Select month",maxDate:m().toDate(),value:c,onChange:e=>{o(""),d(""),x(e.value)}}),a==="search_term"&&s.jsx(B,{className:"w-full md:!w-fit",placeholder:"Search",value:n,onChange:e=>d(e.target.value)}),a==="day_type"&&s.jsx(_,{className:"w-full md:!w-fit",placeholder:"Day Type",options:f,optionLabel:"name",optionValue:"id",value:n,onChange:e=>{d(e.value)}}),s.jsx(_,{placeholder:"Filter by",className:"w-full md:!w-fit",options:[{label:"Employee Name",code:"search_term"},{label:"Day Type",code:"day_type"}],optionLabel:"label",optionValue:"code",value:a,onChange:e=>{d(""),o(e.value)}}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(y,{icon:"pi pi-times",severity:"danger",disabled:!a,onClick:()=>{o(""),d(""),t.current&&t.current.refreshListData()}}),s.jsx(y,{icon:"pi pi-search",disabled:!n||!a,onClick:()=>{t.current&&t.current.refreshListData()}})]})]})}),s.jsx(S,{dataHandler:L,id:"regularisation_requests",headers:F,ref:t})]}),s.jsx(P,{visible:N,onHide:()=>j(!1),leaveRequestData:u,tableRef:t})]})};export{le as default};
