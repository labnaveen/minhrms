import{r,G as l,j as t,ch as k,B as x,af as h,ci as A,$ as j,cj as I}from"./index-3ec7abe5.js";import{I as Y}from"./index.esm-66734f9f.js";import{C as B,D as E}from"./dropdown.esm-1ad10373.js";import{C as y}from"./index-3d6f48ca.js";import{C as M}from"./calendar.esm-f987a87a.js";import{L as i}from"./index-37ade0e2.js";import{T as O}from"./index-b2a6305f.js";import{I as T}from"./inputtext.esm-e49a03d7.js";import"./iconBase-2780a5a8.js";import"./index.esm-9e3aa09b.js";import"./index.esm-be3d6ae7.js";import"./paginator.esm-634e02d4.js";const X=()=>{const a=r.useRef(null),[n,b]=r.useState(""),[c,d]=r.useState(""),[F,g]=r.useState(l().toDate()),[u,p]=r.useState(""),[f,m]=r.useState(""),w="https://api.minhrms.com/",C=async e=>await k({page:e.page+1,records:e.rows,sortBy:e.sortField||"",sortOrder:e.sortOrder?e.sortOrder===-1?"DESC":"ASC":"",month:n?l(n).month()+1:"",year:c?l(c).year():"",status:u,search_term:f}),D=e=>{var s;return t.jsx("div",{className:"flex w-full items-center justify-center gap-3",children:t.jsx("a",{href:`${w+((s=e==null?void 0:e.document)==null?void 0:s.public_url)}`,children:t.jsx(Y,{className:"text-2xl cursor-pointer"})})})},N=async e=>{let s;const o=async R=>{s=await A(e.id),s.status==200&&(j.success("Letter accepted succesfully!"),a.current.refreshListData())};return h({draggable:!1,resizable:!1,message:"Do you want to Accept this letter?",header:"Acceptance Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>o(e.id),reject:()=>{}})},L=async e=>{let s;const o=async R=>{s=await I(e.id),s.status==200&&(j.success("Letter Rejected succesfully!"),a.current.refreshListData())};return h({draggable:!1,resizable:!1,message:"Do you want to reject this letter?",header:"Rejection Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>o(e.id),reject:()=>{}})},S=[{field:"letter_type",header:"Letter Type",sortable:!0},{field:"date",header:"Date",sortable:!0,body:e=>l(e==null?void 0:e.date).format("ddd, MMM DD, YYYY")},{field:"status",header:"Approval Status",body:e=>{if(e.status==3)return t.jsxs("div",{className:"flex gap-2",children:[t.jsx(x,{severity:"success",label:"Accept",className:"py-1",onClick:()=>N(e)}),t.jsx(x,{severity:"danger",label:"Reject",className:"py-1",onClick:()=>L(e)})]});if(e.status==1)return t.jsx("div",{className:"border px-3 py-2 rounded-full w-fit bg-green-500 text-white",children:"Accepted"});if(e.status==2)return t.jsx("div",{className:"border px-3 py-2 rounded-full w-fit bg-red-500 text-white",children:"Rejected"})}},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Download",body:e=>D(e)}],v=[{label:"Accepted",value:1},{label:"Rejected",value:2},{label:"Pending",value:3}];return t.jsxs("div",{className:"flex w-full flex-col",children:[t.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Manage Letters"}),t.jsxs(B,{className:"flex w-full flex-col",children:[t.jsx("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:t.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[t.jsx(i,{title:"Year",children:t.jsx(M,{name:"year",className:"w-full md:!min-w-fit",readOnlyInput:!0,view:"year",dateFormat:"yy",placeholder:"Select a year",maxDate:l().toDate(),value:c,onChange:e=>d(e.value)})}),t.jsx(i,{title:"Status",children:t.jsx(E,{className:"w-full md:!w-fit",placeholder:"Select a status",options:v,optionLabel:"label",optionValue:"value",value:u,onChange:e=>{p(e.value)}})}),t.jsx(i,{title:"Search",children:t.jsx(T,{placeholder:"Search",value:f,onChange:e=>m(e.target.value)})}),t.jsxs("div",{className:"flex gap-3 self-end",children:[t.jsx(y,{icon:"pi pi-times",severity:"danger",onClick:()=>{g(""),d(""),b(""),p(""),m(""),a.current&&a.current.refreshListData()}}),t.jsx(y,{icon:"pi pi-search",onClick:()=>{a.current&&a.current.refreshListData()}})]})]})}),t.jsx(O,{dataHandler:C,id:"letters",headers:S,ref:a})]})]})};export{X as default};
