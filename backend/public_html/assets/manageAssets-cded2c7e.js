import{r as d,G as h,v as E,bR as F,$ as N,bS as M,j as s,f,af as v}from"./index-3ec7abe5.js";import{C as Y}from"./dropdown.esm-1ad10373.js";import{T as k}from"./index-b2a6305f.js";import{E as I}from"./edit-c01b3e15.js";import{P as L}from"./plus-b36a0702.js";import{T as R}from"./trash-4a28e917.js";import{C as b}from"./index-3d6f48ca.js";import{u as V,o as B}from"./validationSchemas-9cdf4188.js";import{I as _}from"./inputtext.esm-e49a03d7.js";import{B as H}from"./index-36dd5a0c.js";import{L as p}from"./index-37ade0e2.js";import{C as O}from"./calendar.esm-f987a87a.js";import{E as T,F as q,G as P,H as $,I as U}from"./api-9d9fddec.js";import{u as y}from"./useDispatch-1aeda00f.js";import{A as G}from"./assignUnassignAsset-c41d0081.js";import"./index.esm-9e3aa09b.js";import"./paginator.esm-634e02d4.js";import"./index.esm-be3d6ae7.js";const Q=({visible:c,onHide:i,tableRef:n,openAssignAssetModal:x})=>{const A=y(),[u]=d.useState(h().format("YYYY-MM-DD")),l=E(F),[a,m]=d.useState(null),j=async r=>{const o=await P(r);o.data.status===200?m(o.data.data):m(null)},e=V({initialValues:{asset_code:(a==null?void 0:a.asset_code)||"",asset_name:(a==null?void 0:a.asset_name)||"",date_of_purchase:(a==null?void 0:a.date_of_purchase)||u,asset_cost:(a==null?void 0:a.asset_cost)||0,description:(a==null?void 0:a.description)||""},validationSchema:B,onSubmit:async r=>{let o;l?o=await q(l,r):o=await T(r),(o.status===201||o.status===200)&&(g(),N.success(o.message),n.current.refreshListData(),l||x(o.data.data))},enableReinitialize:!0}),w=[{label:l?"Update":"Add",onClick:e.handleSubmit,className:"min-w-[90px]",loading:e.isSubmitting}],g=()=>{A(M("")),e.resetForm(),m(null),i(!1)};return d.useEffect(()=>{c&&l&&j(l)},[c,l]),s.jsx(H,{header:`${l?"Update":"Add"} Asset`,visible:c,onHide:g,actions:w,children:s.jsxs("div",{className:"m-auto grid w-full gap-3",children:[s.jsx(p,{required:!0,title:"Asset Code",showError:e.errors.asset_code&&e.touched.asset_code,errorMessages:e.errors.asset_code,children:s.jsx(_,{name:"asset_code",value:e.values.asset_code,className:f("w-full",{"p-invalid text-red-500":e.errors.asset_code&&e.touched.asset_code}),onChange:r=>e.setFieldValue("asset_code",r.target.value)})}),s.jsx(p,{required:!0,title:"Asset Name",showError:e.errors.asset_name&&e.touched.asset_name,errorMessages:e.errors.asset_name,children:s.jsx(_,{name:"asset_name",value:e.values.asset_name,className:f("w-full",{"p-invalid text-red-500":e.errors.asset_name&&e.touched.asset_name}),onChange:r=>e.setFieldValue("asset_name",r.target.value)})}),s.jsx(p,{title:"Date Of Purchase",required:!0,showError:e.errors.date_of_purchase&&e.touched.date_of_purchase,errorMessages:e.errors.date_of_purchase,children:s.jsx(O,{readOnlyInput:!0,name:"date_of_purchase",dateFormat:"dd-mm-yy",maxDate:h().toDate(),value:h(e.values.date_of_purchase,"YYYY-MM-DD").toDate(),className:f("w-full",{"p-invalid text-red-500":e.errors.date_of_purchase&&e.touched.date_of_purchase}),onChange:r=>{e.setFieldValue("date_of_purchase",h(r.value).format("YYYY-MM-DD"))}})}),s.jsx(p,{title:"Asset Cost",required:!0,showError:e.errors.asset_cost&&e.touched.asset_cost,errorMessages:e.errors.asset_cost,children:s.jsx(_,{name:"asset_cost",type:"number",min:0,value:e.values.asset_cost,className:f("w-full",{"p-invalid text-red-500":e.errors.asset_cost&&e.touched.asset_cost}),onChange:r=>e.setFieldValue("asset_cost",r.target.value)})}),s.jsx(p,{className:"md:col-span-2",title:"Description",showError:e.errors.description&&e.touched.description,errorMessages:e.errors.description,children:s.jsx(_,{name:"description",value:e.values.description,className:f("w-full",{"p-invalid text-red-500":e.errors.description&&e.touched.description}),onChange:r=>e.setFieldValue("description",r.target.value)})})]})})},me=()=>{const c=y(),i=d.useRef(null),[n,x]=d.useState(""),[A,u]=d.useState(!1),[l,a]=d.useState(!1),[m,j]=d.useState(""),e=async t=>await $({filterBy:"search_term",filterValue:n,page:t.page+1,records:t.rows,sortBy:t.sortField?t.sortField:"",sortOrder:t.sortField?t.sortOrder===-1?"DESC":"ASC":""}),w=t=>{let C;const D=async S=>{C=await U(S),C.status===200&&(N.success(C.message),i.current.refreshListData())};return v({draggable:!1,resizable:!1,message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",rejectClassName:"p-button-link mr-2",accept:()=>D(t.id),reject:()=>{}})},g=t=>v({draggable:!1,resizable:!1,message:`Do you want to assign asset, ${t.asset_name} (${t.asset_code})?`,header:"Assign Asset Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button",rejectClassName:"p-button-link text-red-500 mr-2",accept:()=>{j(t.id),a(!0)},reject:()=>{}}),o=[{field:"asset_code",header:"Asset Code",sortable:!0},{field:"asset_name",header:"Asset Name",sortable:!0},{field:"date_of_purchase",header:"Date Of Purchase",sortable:!0,body:t=>h(t==null?void 0:t.date_of_purchase).format("DD/MM/yy")},{field:"description",header:"Description"},{field:"asset_cost",header:"Asset Cost",sortable:!0},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:t=>s.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[s.jsx("img",{className:"cursor-pointer",width:25,height:25,src:I,onClick:()=>{c(M(t.id)),u(!0)}}),s.jsx("img",{className:"cursor-pointer",width:25,height:25,src:R,onClick:()=>w(t)})]})}];return s.jsxs("div",{className:"flex w-full flex-col",children:[s.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Manage Assets"}),s.jsxs(Y,{className:"flex w-full flex-col",children:[s.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[s.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[s.jsx(_,{placeholder:"Asset name/code",value:n,onChange:t=>x(t.target.value)}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(b,{icon:"pi pi-times",severity:"danger",onClick:()=>{x(""),i.current&&i.current.refreshListData()}}),s.jsx(b,{icon:"pi pi-search",disabled:!n,onClick:()=>{i.current&&i.current.refreshListData()}})]})]}),s.jsx(b,{raised:!0,label:"Add Asset",icon:s.jsx("img",{src:L}),onClick:()=>u(!0)})]}),s.jsx(k,{dataHandler:e,id:"asset_list",headers:o,ref:i})]}),s.jsx(Q,{visible:A,onHide:()=>u(!1),tableRef:i,openAssignAssetModal:g}),s.jsx(G,{visible:l,onHide:()=>a(!1),tableRef:i,newAssetId:m})]})};export{me as default};
