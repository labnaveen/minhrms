import{r as c,v as W,b_ as z,$ as K,b$ as Y,j as s,f as o,c0 as P,c1 as Z,G as b,c2 as D,c3 as ee,af as re}from"./index-3ec7abe5.js";import{D as S,C as se}from"./dropdown.esm-1ad10373.js";import{T as ae}from"./index-b2a6305f.js";import{E as ie}from"./edit-c01b3e15.js";import{P as te}from"./plus-b36a0702.js";import{T as le}from"./trash-4a28e917.js";import{T as oe}from"./index-c74eb1f3.js";import{C as U}from"./index-3d6f48ca.js";import{u as J,t as ne,S as ue}from"./validationSchemas-9cdf4188.js";import{I as p}from"./inputtext.esm-e49a03d7.js";import{C as x}from"./checkbox.esm-7c1abfc1.js";import{I as f}from"./inputswitch.esm-65362ee3.js";import{M as de}from"./multiselect.esm-15dd71d0.js";import{B as Q}from"./index-36dd5a0c.js";import{L as t}from"./index-37ade0e2.js";import{a as _e,u as me,f as A,b as he,c as ce,d as fe,e as pe,g as ge,h as xe,i as ve,j as be,k as we,r as je,l as ye,m as ke}from"./api-f3ada6c1.js";import{I as v}from"./paginator.esm-634e02d4.js";import{u as X}from"./useDispatch-1aeda00f.js";import{C as $}from"./calendar.esm-f987a87a.js";import"./index.esm-9e3aa09b.js";import"./index.esm-be3d6ae7.js";const Fe=({visible:n,onHide:w,tableRef:u})=>{const V=X(),g=3,[_,j]=c.useState(1),[r,y]=c.useState(null),m=W(z),[k,C]=c.useState([]),[N,q]=c.useState([]),L=async()=>{const a=await A(),h=await he();C(a.status===200?a.data.data:[]),q(h.status===200?h.data.data:[])},T=async a=>{const h=await ce(a);h.data.status===200?y(h.data.data):y(null)},E=()=>r?!!(r!=null&&r.display_overtime_hours||r!=null&&r.display_deficit_hours||r!=null&&r.display_late_mark||r!=null&&r.display_average_working_hours||r!=null&&r.display_average_in_time||r!=null&&r.display_average_out_time||r!=null&&r.display_number_of_leaves_taken||r!=null&&r.display_present_number_of_days||r!=null&&r.display_absent_number_of_days):!1,e=J({initialValues:{name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||"",biometric:(r==null?void 0:r.biometric)||!1,web:(r==null?void 0:r.web)||!1,app:(r==null?void 0:r.app)||!1,manual:(r==null?void 0:r.manual)||!1,attendance_cycle_start:(r==null?void 0:r.attendance_cycle_start)||1,default_attendance_status:(r==null?void 0:r.default_attendance_status)||4,regularisation_status:(r==null?void 0:r.attendance_statuses.map(a=>a.id))||[],half_day:(r==null?void 0:r.half_day)||!1,min_hours_for_half_day:(r==null?void 0:r.min_hours_for_half_day)||0,show_display_rules_for_employees:E(),display_overtime_hours:(r==null?void 0:r.display_overtime_hours)||!1,display_deficit_hours:(r==null?void 0:r.display_deficit_hours)||!1,display_late_mark:(r==null?void 0:r.display_late_mark)||!1,display_average_working_hours:(r==null?void 0:r.display_average_working_hours)||!1,display_average_in_time:(r==null?void 0:r.display_average_in_time)||!1,display_average_out_time:(r==null?void 0:r.display_average_out_time)||!1,display_number_of_leaves_taken:(r==null?void 0:r.display_number_of_leaves_taken)||!1,display_present_number_of_days:(r==null?void 0:r.display_present_number_of_days)||!1,display_absent_number_of_days:(r==null?void 0:r.display_absent_number_of_days)||!1,call_out_regularisation:(r==null?void 0:r.call_out_regularisation)||!1,round_off:(r==null?void 0:r.round_off)||!1,auto_approval_attendance_request:(r==null?void 0:r.auto_approval_attendance_request)||!1,regularisation_restriction:(r==null?void 0:r.regularisation_restriction)||!1,regularisation_restriction_limit:(r==null?void 0:r.regularisation_restriction_limit)||0,regularisation_limit_for_month:(r==null?void 0:r.regularisation_limit_for_month)||0,bypass_regularisation_proxy:(r==null?void 0:r.bypass_regularisation_proxy)||!1,mobile_app_restriction:(r==null?void 0:r.mobile_app_restriction)||!1,number_of_devices_allowed:(r==null?void 0:r.number_of_devices_allowed)||0},validationSchema:ne,onSubmit:async a=>{let h;m?h=await me(m,a):h=await _e(a),(h.status===201||h.status===200)&&(M(),K.success(h.message),u.current.refreshListData())},enableReinitialize:!0}),H=()=>{j(a=>a+1)},O=[{label:"Previous",onClick:()=>{j(a=>a-1)},variant:"secondary",className:"min-w-[90px]",visible:_>1},{label:"Next",onClick:H,className:"min-w-[90px]",visible:_<g},{label:m?"Update":"Add",onClick:e.handleSubmit,className:"min-w-[90px]",visible:_===g,loading:e.isSubmitting}],M=()=>{j(1),V(Y("")),e.resetForm(),y(null),w(!1)};return c.useEffect(()=>{L()},[]),c.useEffect(()=>{n&&m&&T(m)},[n,m]),s.jsx(Q,{header:`${m?"Update":"Add"} Attendance Policy`,visible:n,onHide:M,progressValue:_/g,formikInstance:e,actions:O,children:s.jsxs("div",{className:"m-auto grid w-full grid-cols-1 gap-3 md:grid-cols-2",children:[_===1&&s.jsxs(s.Fragment,{children:[s.jsx(t,{htmlFor:"name",required:!0,title:"Policy Name",showError:e.errors.name&&e.touched.name,errorMessages:e.errors.name,children:s.jsx(p,{name:"name",value:e.values.name,className:o("w-full",{"p-invalid text-red-500":e.errors.name&&e.touched.name}),onChange:a=>e.setFieldValue("name",a.target.value)})}),s.jsx(t,{required:!0,title:"Description",showError:e.errors.description&&e.touched.description,errorMessages:e.errors.description,children:s.jsx(p,{name:"description",value:e.values.description,className:o("w-full",{"p-invalid text-red-500":e.errors.description&&e.touched.description}),onChange:a=>e.setFieldValue("description",a.target.value)})}),s.jsx(t,{required:!0,title:"Allow Attendance By",className:"md:col-span-2",showError:e.errors.biometric&&e.touched.biometric,errorMessages:e.errors.biometric,children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx(t,{htmlFor:"biometric",title:"Biometric",inlineEnd:!0,children:s.jsx(x,{name:"allow_attendance_by",inputId:"biometric",onChange:a=>e.setFieldValue("biometric",a.checked),checked:e.values.biometric,className:o("w-full",{"p-invalid text-red-500":e.errors.biometric&&e.touched.biometric})})}),s.jsx(t,{htmlFor:"web",title:"Web",inlineEnd:!0,children:s.jsx(x,{name:"allow_attendance_by",inputId:"web",onChange:a=>e.setFieldValue("web",a.checked),checked:e.values.web,className:o("w-full",{"p-invalid text-red-500":e.errors.biometric&&e.touched.biometric})})}),s.jsx(t,{htmlFor:"app",title:"App",inlineEnd:!0,children:s.jsx(x,{name:"allow_attendance_by",inputId:"app",onChange:a=>e.setFieldValue("app",a.checked),checked:e.values.app,className:o("w-full",{"p-invalid text-red-500":e.errors.biometric&&e.touched.biometric})})}),s.jsx(t,{htmlFor:"manual",title:"Manual",inlineEnd:!0,children:s.jsx(x,{name:"allow_attendance_by",inputId:"manual",onChange:a=>e.setFieldValue("manual",a.checked),checked:e.values.manual,className:o("w-full",{"p-invalid text-red-500":e.errors.biometric&&e.touched.biometric})})})]})}),N.length>0&&s.jsx(t,{required:!0,title:"Attendance Cycle Start From",children:s.jsx(S,{id:"attendance_cycle_start",dataKey:a=>`attendance-cycle-start-${a.id}`,options:N,optionLabel:"day",optionValue:"id",value:e.values.attendance_cycle_start,onChange:a=>e.setFieldValue("attendance_cycle_start",a.value)})}),k.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(t,{title:"Default Attendance Status",children:s.jsx(S,{id:"default_attendance_status",dataKey:a=>`default-attendance-status-${a.id}`,options:k,optionLabel:"name",optionValue:"id",value:e.values.default_attendance_status,onChange:a=>e.setFieldValue("default_attendance_status",a.value)})}),s.jsx(t,{required:!0,className:"md:col-span-2",title:"Regularisation Status",showError:e.errors.regularisation_status&&e.touched.regularisation_status,errorMessages:e.errors.regularisation_status,children:s.jsx(de,{inputId:"regularisation_status",options:k,display:"chip",optionLabel:"name",optionValue:"id",placeholder:"Select Regularisation Statuses",value:e.values.regularisation_status,className:o("w-full",{"p-invalid text-red-500":e.errors.regularisation_status&&e.touched.regularisation_status}),onChange:a=>e.setFieldValue("regularisation_status",a.value),pt:{token:{className:"!h-4/5 !rounded-[0.25rem] !bg-[#37B3E0] !text-white !py-1 !px-2 !text-[0.75rem]"},removeTokenIcon:{className:"w-max h-max"}}})})]}),s.jsx(t,{title:"Allow Half Day",children:s.jsx(f,{name:"half_day",checked:e.values.half_day,onChange:a=>{e.setFieldValue("half_day",a.value),a.value?e.setFieldValue("min_hours_for_half_day",240):e.setFieldValue("min_hours_for_half_day",0)}})}),e.values.half_day&&s.jsx(t,{required:!0,title:"Minimum Hours For Half Day (in minutes)",showError:e.errors.min_hours_for_half_day&&e.touched.min_hours_for_half_day,errorMessages:e.errors.min_hours_for_half_day,children:s.jsx(v,{id:"min_hours_for_half_day",useGrouping:!1,min:1,maxLength:3,value:e.values.min_hours_for_half_day,className:o("w-full",{"p-invalid text-red-500":e.errors.min_hours_for_half_day&&e.touched.min_hours_for_half_day}),onValueChange:a=>e.setFieldValue("min_hours_for_half_day",a.value)})})]}),_===2&&s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"md:col-span-2",title:"Display Rules For Employees",children:s.jsx(f,{name:"show_display_rules_for_employees",checked:e.values.show_display_rules_for_employees,onChange:a=>{e.setFieldValue("show_display_rules_for_employees",a.value),a.value||(e.setFieldValue("display_overtime_hours",!1),e.setFieldValue("display_deficit_hours",!1),e.setFieldValue("display_late_mark",!1),e.setFieldValue("display_average_working_hours",!1),e.setFieldValue("display_average_in_time",!1),e.setFieldValue("display_average_out_time",!1),e.setFieldValue("display_number_of_leaves_taken",!1),e.setFieldValue("display_present_number_of_days",!1),e.setFieldValue("display_absent_number_of_days",!1))}})}),e.values.show_display_rules_for_employees&&s.jsxs("div",{className:"col-span-2 m-auto grid grid-cols-3 gap-3",children:[s.jsx(t,{title:"Overtime Hours",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_overtime_hours",onChange:a=>e.setFieldValue("display_overtime_hours",a.checked),checked:e.values.display_overtime_hours})}),s.jsx(t,{title:"Deficit Hours",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_deficit_hours",onChange:a=>e.setFieldValue("display_deficit_hours",a.checked),checked:e.values.display_deficit_hours})}),s.jsx(t,{title:"Late Mark",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_late_mark",onChange:a=>e.setFieldValue("display_late_mark",a.checked),checked:e.values.display_late_mark})}),s.jsx(t,{title:"Average Working Hours",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_average_working_hours",onChange:a=>e.setFieldValue("display_average_working_hours",a.checked),checked:e.values.display_average_working_hours})}),s.jsx(t,{title:"Average In Time",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_average_in_time",onChange:a=>e.setFieldValue("display_average_in_time",a.checked),checked:e.values.display_average_in_time})}),s.jsx(t,{title:"Average Out Time",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_average_out_time",onChange:a=>e.setFieldValue("display_average_out_time",a.checked),checked:e.values.display_average_out_time})}),s.jsx(t,{title:"Total Leaves Consumed",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_number_of_leaves_taken",onChange:a=>e.setFieldValue("display_number_of_leaves_taken",a.checked),checked:e.values.display_number_of_leaves_taken})}),s.jsx(t,{title:"No. Of Days Present",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_present_number_of_days",onChange:a=>e.setFieldValue("display_present_number_of_days",a.checked),checked:e.values.display_present_number_of_days})}),s.jsx(t,{title:"No. Of Days Absent",inlineEnd:!0,children:s.jsx(x,{name:"display_role_for_employees",inputId:"display_absent_number_of_days",onChange:a=>e.setFieldValue("display_absent_number_of_days",a.checked),checked:e.values.display_absent_number_of_days})})]}),s.jsx(t,{title:"Allow Call-out Regularisation",children:s.jsx(f,{name:"call_out_regularisation",checked:e.values.call_out_regularisation,onChange:a=>e.setFieldValue("call_out_regularisation",a.value)})}),s.jsx(t,{title:"Allow Round-Off",children:s.jsx(f,{name:"round_off",checked:e.values.round_off,onChange:a=>e.setFieldValue("round_off",a.value)})}),s.jsx(t,{title:"Allow Auto-Approval For Attendance Request",children:s.jsx(f,{name:"auto_approval_attendance_request",checked:e.values.auto_approval_attendance_request,onChange:a=>e.setFieldValue("auto_approval_attendance_request",a.value)})})]}),_===3&&s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"md:col-span-2",title:"Enable restriction for regularisation request",children:s.jsx(f,{name:"regularisation_restriction",checked:e.values.regularisation_restriction,onChange:a=>{e.setFieldValue("regularisation_restriction",a.value),a.value?(e.setFieldValue("regularisation_restriction_limit",5),e.setFieldValue("regularisation_limit_for_month",1)):(e.setFieldValue("regularisation_restriction_limit",0),e.setFieldValue("regularisation_limit_for_month",0))}})}),e.values.regularisation_restriction&&s.jsxs(s.Fragment,{children:[s.jsx(t,{required:!0,title:"Set limit for back-dated regularisation (in days)",showError:e.errors.regularisation_restriction_limit&&e.touched.regularisation_restriction_limit,errorMessages:e.errors.regularisation_restriction_limit,children:s.jsx(v,{useGrouping:!1,min:1,maxLength:3,id:"regularisation_restriction_limit",value:e.values.regularisation_restriction_limit,className:o("w-full",{"p-invalid text-red-500":e.errors.regularisation_restriction_limit&&e.touched.regularisation_restriction_limit}),onValueChange:a=>e.setFieldValue("regularisation_restriction_limit",a.value)})}),s.jsx(t,{required:!0,title:"Set limit for number of regularisations in a month",showError:e.errors.regularisation_limit_for_month&&e.touched.regularisation_limit_for_month,errorMessages:e.errors.regularisation_limit_for_month,children:s.jsx(v,{useGrouping:!1,min:1,maxLength:2,id:"regularisation_limit_for_month",value:e.values.regularisation_limit_for_month,className:o("w-full",{"p-invalid text-red-500":e.errors.regularisation_limit_for_month&&e.touched.regularisation_limit_for_month}),onValueChange:a=>e.setFieldValue("regularisation_limit_for_month",a.value)})})]}),s.jsx(t,{className:"md:col-span-2",title:"Bypass regularisation restrictions when proxy",children:s.jsx(f,{name:"bypass_regularisation_proxy",checked:e.values.bypass_regularisation_proxy,onChange:a=>e.setFieldValue("bypass_regularisation_proxy",a.value)})}),s.jsx(t,{className:"md:col-span-2",title:"Enable Restriction for mobile app login",children:s.jsx(f,{name:"mobile_app_restriction",checked:e.values.mobile_app_restriction,onChange:a=>{e.setFieldValue("mobile_app_restriction",a.value),a.value?e.setFieldValue("number_of_devices_allowed",1):e.setFieldValue("number_of_devices_allowed",0)}})}),e.values.mobile_app_restriction&&s.jsx(t,{required:!0,title:"No of devices allowed",showError:e.errors.number_of_devices_allowed&&e.touched.number_of_devices_allowed,errorMessages:e.errors.number_of_devices_allowed,children:s.jsx(v,{useGrouping:!1,min:1,maxLength:2,id:"number_of_devices_allowed",value:e.values.number_of_devices_allowed,className:o("w-full",{"p-invalid text-red-500":e.errors.number_of_devices_allowed&&e.touched.number_of_devices_allowed}),onValueChange:a=>e.setFieldValue("number_of_devices_allowed",a.value)})})]})]})})},Ve=({visible:n,onHide:w,tableRef:u})=>{var h,B,l,G,I,F;const V=X(),g=3,[_,j]=c.useState(1),[r,y]=c.useState(null),m=W(P),[k,C]=c.useState([]),[N,q]=c.useState([]),L=async()=>{const i=await A(),d=await ge();C(i.status===200?i.data.data:[]),q(d.status===200?d.data.data:[])},T=async i=>{const d=await xe(i);d.data.status===200?y(d.data.data):y(null)},E=(i,d)=>b(i,"HH:mm").add(d,"minutes").format("HH:mm"),e=J({initialValues:{shift_name:(r==null?void 0:r.shift_name)||"",shift_description:(r==null?void 0:r.shift_description)||"",notes_for_punch:(r==null?void 0:r.notes_for_punch)||!1,allow_single_punch:(r==null?void 0:r.allow_single_punch)||!1,shift_type_id:(r==null?void 0:r.shift_type_id)||1,shift_start_time:(r==null?void 0:r.shift_start_time)||"09:00:00",shift_end_time:(r==null?void 0:r.shift_end_time)||"18:00:00",base_working_hours:(r==null?void 0:r.base_working_hours)||0,pre_shift_duration:(r==null?void 0:r.pre_shift_duration)||0,post_shift_duration:(r==null?void 0:r.post_shift_duration)||0,consider_breaks:(r==null?void 0:r.consider_breaks)||!1,break_duration:(r==null?void 0:r.break_duration)||30,break_start_time:(r==null?void 0:r.break_start_time)||"13:00:00",break_end_time:(r==null?void 0:r.break_end_time)||"13:30:00",enable_grace:(r==null?void 0:r.enable_grace)||!1,grace_duration_allowed:(r==null?void 0:r.grace_duration_allowed)||30,number_of_days_grace_allowed:(r==null?void 0:r.number_of_days_grace_allowed)||5,status_grace_exceeded:(r==null?void 0:r.status_grace_exceeded)||1,enable_grace_recurring:(r==null?void 0:r.enable_grace_recurring)||!1,enable_flex:(r==null?void 0:r.enable_flex)||!1,flex_start_time:(r==null?void 0:r.flex_start_time)||30,flexi_duration_allowed:(r==null?void 0:r.flexi_duration_allowed)||30,number_of_days_flexi_allowed:(r==null?void 0:r.number_of_days_flexi_allowed)||5,status_flexi_exceeded:(r==null?void 0:r.status_flexi_exceeded)||1,status_punch_in_time_exceeded:(r==null?void 0:r.status_punch_in_time_exceeded)||1,enable_flex_recurring:(r==null?void 0:r.enable_flex_recurring)||!1},validationSchema:ue,onSubmit:async i=>{let d;m?d=await pe(m,i):d=await fe(i),(d.status===201||d.status===200)&&(a(),K.success(d.message),u.current.refreshListData())},enableReinitialize:!0}),H=()=>{var i;return((i=e.values)==null?void 0:i.shift_type_id)===1?g:g-1},R=()=>{j(i=>i+1)},M=[{label:"Previous",onClick:()=>{j(i=>i-1)},className:"min-w-[90px]",visible:_>1,variant:"secondary"},{label:"Next",onClick:R,className:"min-w-[90px]",visible:_<H()},{label:m?"Update":"Add",onClick:e.handleSubmit,className:"min-w-[90px]",visible:_===H(),loading:e.isSubmitting}],a=()=>{j(1),V(Z("")),e.resetForm(),y(null),w(!1)};return c.useEffect(()=>{n&&L()},[n]),c.useEffect(()=>{n&&m&&T(m)},[n,m]),s.jsx(Q,{header:`${m?"Update":"Add"} Shift Policy`,visible:n,onHide:a,progressValue:_/H(),formikInstance:e,actions:M,children:s.jsxs("div",{className:"m-auto grid w-full grid-cols-1 gap-3 md:grid-cols-2",children:[_===1&&s.jsxs(s.Fragment,{children:[s.jsx("h6",{className:"md:col-span-2",children:"Basic Information"}),s.jsx(t,{htmlFor:"shift_name",required:!0,title:"Shift Name",showError:e.errors.shift_name&&e.touched.shift_name,errorMessages:e.errors.shift_name,children:s.jsx(p,{name:"shift_name",value:e.values.shift_name,className:o("w-full",{"p-invalid text-red-500":e.errors.shift_name&&e.touched.shift_name}),onChange:i=>e.setFieldValue("shift_name",i.target.value)})}),s.jsx(t,{htmlFor:"shift_description",required:!0,title:"Description",showError:e.errors.shift_description&&e.touched.shift_description,errorMessages:e.errors.shift_description,children:s.jsx(p,{name:"shift_description",value:e.values.shift_description,className:o("w-full",{"p-invalid text-red-500":e.errors.shift_description&&e.touched.shift_description}),onChange:i=>e.setFieldValue("shift_description",i.target.value)})}),s.jsx(t,{title:"Allow notes for punch-in / punch-out",children:s.jsx(f,{name:"notes_for_punch",checked:e.values.notes_for_punch,onChange:i=>e.setFieldValue("notes_for_punch",i.value)})}),s.jsx(t,{title:"Allow single Punch-in",children:s.jsx(f,{name:"allow_single_punch",checked:e.values.allow_single_punch,onChange:i=>e.setFieldValue("allow_single_punch",i.value)})}),s.jsx(t,{className:"md:col-span-2",required:!0,title:"Shift Type",children:s.jsx(S,{options:N,optionLabel:"name",optionValue:"id",value:e.values.shift_type_id,onChange:i=>{e.setFieldValue("shift_type_id",i.value),i.value===1?(e.setFieldValue("shift_start_time","09:00:00"),e.setFieldValue("shift_end_time","18:00:00"),e.setFieldValue("pre_shift_duration",30),e.setFieldValue("post_shift_duration",30),e.setFieldValue("base_working_hours",0)):(e.setFieldValue("base_working_hours",480),e.setFieldValue("shift_start_time",""),e.setFieldValue("shift_end_time",""),e.setFieldValue("pre_shift_duration",0),e.setFieldValue("post_shift_duration",0))}})}),((h=e.values)==null?void 0:h.shift_type_id)===1&&s.jsxs(s.Fragment,{children:[s.jsx(t,{required:!0,title:"Start Time",showError:e.errors.shift_start_time&&e.touched.shift_start_time,errorMessages:e.errors.shift_start_time,children:s.jsx($,{hourFormat:"24",readOnlyInput:!0,value:b(e.values.shift_start_time,"HH:mm:ss").toDate(),className:o("w-full",{"p-invalid text-red-500":e.errors.shift_start_time&&e.touched.shift_start_time}),onChange:i=>e.setFieldValue("shift_start_time",b(i.value).format("HH:mm:ss")),timeOnly:!0})}),s.jsx(t,{required:!0,title:"End Time",showError:e.errors.shift_end_time&&e.touched.shift_end_time,errorMessages:e.errors.shift_end_time,children:s.jsx($,{hourFormat:"24",readOnlyInput:!0,value:b(e.values.shift_end_time,"HH:mm:ss").toDate()||"",className:o("w-full",{"p-invalid text-red-500":e.errors.shift_end_time&&e.touched.shift_end_time}),onChange:i=>e.setFieldValue("shift_end_time",b(i.value).format("HH:mm:ss")),timeOnly:!0})}),s.jsx(t,{htmlFor:"pre_shift_duration",required:!0,title:"Pre-shift Duration (in minutes)",showError:e.errors.pre_shift_duration&&e.touched.pre_shift_duration,errorMessages:e.errors.pre_shift_duration,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:3,name:"pre_shift_duration",value:e.values.pre_shift_duration,className:o("w-full",{"p-invalid text-red-500":e.errors.pre_shift_duration&&e.touched.pre_shift_duration}),onValueChange:i=>e.setFieldValue("pre_shift_duration",i.value)})}),s.jsx(t,{htmlFor:"post_shift_duration",required:!0,title:"Post-shift Duration (in minutes)",showError:e.errors.post_shift_duration&&e.touched.post_shift_duration,errorMessages:e.errors.post_shift_duration,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:3,name:"post_shift_duration",value:e.values.post_shift_duration,className:o("w-full",{"p-invalid text-red-500":e.errors.post_shift_duration&&e.touched.post_shift_duration}),onValueChange:i=>e.setFieldValue("post_shift_duration",i.value)})})]}),((B=e.values)==null?void 0:B.shift_type_id)===2&&s.jsx(t,{htmlFor:"base_working_hours",required:!0,title:"Total Shift Hours (in minutes)",showError:e.errors.base_working_hours&&e.touched.base_working_hours,errorMessages:e.errors.base_working_hours,children:s.jsx(v,{useGrouping:!1,format:!1,min:0,maxLength:4,name:"base_working_hours",value:e.values.base_working_hours,className:o("w-full",{"p-invalid text-red-500":e.errors.base_working_hours&&e.touched.base_working_hours}),onValueChange:i=>e.setFieldValue("base_working_hours",i.value)})})]}),_===2&&s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"md:col-span-2",title:"Consider breaks in calculation",children:s.jsx(f,{name:"consider_breaks",checked:e.values.consider_breaks,onChange:i=>e.setFieldValue("consider_breaks",i.value)})}),((l=e.values)==null?void 0:l.consider_breaks)&&s.jsxs(s.Fragment,{children:[s.jsx(t,{htmlFor:"break_duration",className:"md:col-span-2",required:!0,title:"Break Duration (in minutes)",showError:e.errors.break_duration&&e.touched.break_duration,errorMessages:e.errors.break_duration,children:s.jsx(v,{useGrouping:!1,name:"break_duration",min:0,maxLength:3,value:e.values.break_duration,className:o("w-full",{"p-invalid text-red-500":e.errors.break_duration&&e.touched.break_duration}),onValueChange:i=>{e.setFieldValue("break_duration",i.value),e.setFieldValue("break_end_time",b(e.values.break_start_time,"HH:mm:ss").add((i==null?void 0:i.value)||0,"minutes").format("HH:mm:ss"))}})}),((G=e.values)==null?void 0:G.shift_type_id)===1&&s.jsxs(s.Fragment,{children:[s.jsx(t,{required:!0,title:"Break Start Time",showError:e.errors.break_start_time&&e.touched.break_start_time,errorMessages:e.errors.break_start_time,children:s.jsx($,{hourFormat:"24",readOnlyInput:!0,value:b(e.values.break_start_time,"HH:mm:ss").toDate(),className:o("w-full",{"p-invalid text-red-500":e.errors.break_start_time&&e.touched.break_start_time}),onChange:i=>{var d;e.setFieldValue("break_start_time",b(i.value).format("HH:mm:ss")),e.setFieldValue("break_end_time",b(i.value).add(((d=e.values)==null?void 0:d.break_duration)||0,"minutes").format("HH:mm:ss"))},timeOnly:!0})}),s.jsx(t,{required:!0,title:"Break End Time",showError:e.errors.break_end_time&&e.touched.break_end_time,errorMessages:e.errors.break_end_time,children:s.jsx($,{hourFormat:"24",readOnlyInput:!0,value:b(e.values.break_end_time,"HH:mm:ss").toDate(),className:o("w-full",{"p-invalid text-red-500":e.errors.break_end_time&&e.touched.break_end_time}),onChange:i=>{var d;e.setFieldValue("break_end_time",b(i.value).format("HH:mm:ss")),e.setFieldValue("break_start_time",b(i.value).subtract(((d=e.values)==null?void 0:d.break_duration)||0,"minutes").format("HH:mm:ss"))},timeOnly:!0})})]})]}),s.jsx(t,{className:"md:col-span-2",title:"Enable Grace",children:s.jsx(f,{name:"enable_grace",checked:e.values.enable_grace,onChange:i=>e.setFieldValue("enable_grace",i.value)})}),((I=e.values)==null?void 0:I.enable_grace)&&s.jsxs(s.Fragment,{children:[s.jsx(t,{htmlFor:"grace_duration_allowed",required:!0,title:"Grace duration allowed (in minutes)",showError:e.errors.grace_duration_allowed&&e.touched.grace_duration_allowed,errorMessages:e.errors.grace_duration_allowed,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:4,name:"grace_duration_allowed",value:e.values.grace_duration_allowed,className:o("w-full",{"p-invalid text-red-500":e.errors.grace_duration_allowed&&e.touched.grace_duration_allowed}),onValueChange:i=>e.setFieldValue("grace_duration_allowed",i.value)})}),s.jsx(t,{htmlFor:"number_of_days_grace_allowed",required:!0,title:"Number of days grace allowed",showError:e.errors.number_of_days_grace_allowed&&e.touched.number_of_days_grace_allowed,errorMessages:e.errors.number_of_days_grace_allowed,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:2,name:"number_of_days_grace_allowed",value:e.values.number_of_days_grace_allowed,className:o("w-full",{"p-invalid text-red-500":e.errors.number_of_days_grace_allowed&&e.touched.number_of_days_grace_allowed}),onValueChange:i=>e.setFieldValue("number_of_days_grace_allowed",i.value)})}),s.jsx(t,{required:!0,title:`If grace exceeded by ${e.values.number_of_days_grace_allowed} days, then mark`,children:s.jsx(S,{options:k,optionLabel:"name",optionValue:"id",value:e.values.status_grace_exceeded,onChange:i=>e.setFieldValue("status_grace_exceeded",i.value)})}),s.jsx(t,{title:"Recurring",children:s.jsx(f,{name:"enable_grace_recurring",checked:e.values.enable_grace_recurring,onChange:i=>e.setFieldValue("enable_grace_recurring",i.value)})})]})]}),_===3&&s.jsxs(s.Fragment,{children:[s.jsx(t,{className:"md:col-span-2",title:"Enable Flexi",children:s.jsx(f,{name:"enable_flex",checked:e.values.enable_flex,onChange:i=>e.setFieldValue("enable_flex",i.value)})}),((F=e.values)==null?void 0:F.enable_flex)&&s.jsxs(s.Fragment,{children:[s.jsx(t,{htmlFor:"flex_start_time",required:!0,title:"Flexi Start Time (in minutes)",showError:e.errors.flex_start_time&&e.touched.flex_start_time,errorMessages:e.errors.flex_start_time,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:3,name:"flex_start_time",value:e.values.flex_start_time,className:o("w-full",{"p-invalid text-red-500":e.errors.flex_start_time&&e.touched.flex_start_time}),onValueChange:i=>e.setFieldValue("flex_start_time",i.value)})}),s.jsx(t,{htmlFor:"flexi_duration_allowed",required:!0,title:"Flexi duration allowed (in minutes)",showError:e.errors.flexi_duration_allowed&&e.touched.flexi_duration_allowed,errorMessages:e.errors.flexi_duration_allowed,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:3,name:"flexi_duration_allowed",value:e.values.flexi_duration_allowed,className:o("w-full",{"p-invalid text-red-500":e.errors.flexi_duration_allowed&&e.touched.flexi_duration_allowed}),onValueChange:i=>e.setFieldValue("flexi_duration_allowed",i.value)})}),s.jsx(t,{htmlFor:"number_of_days_flexi_allowed",required:!0,title:"Number of days flexi allowed",showError:e.errors.number_of_days_flexi_allowed&&e.touched.number_of_days_flexi_allowed,errorMessages:e.errors.number_of_days_flexi_allowed,children:s.jsx(v,{useGrouping:!1,min:0,maxLength:2,name:"number_of_days_flexi_allowed",value:e.values.number_of_days_flexi_allowed,className:o("w-full",{"p-invalid text-red-500":e.errors.number_of_days_flexi_allowed&&e.touched.number_of_days_flexi_allowed}),onValueChange:i=>e.setFieldValue("number_of_days_flexi_allowed",i.value)})}),s.jsx(t,{required:!0,title:`If flexi exceeded by ${e.values.number_of_days_flexi_allowed} days, then mark`,children:s.jsx(S,{options:k,optionLabel:"name",optionValue:"id",value:e.values.status_flexi_exceeded,onChange:i=>e.setFieldValue("status_flexi_exceeded",i.value)})}),s.jsx(t,{required:!0,title:`If punch in time exceeded by ${E(e.values.shift_start_time,parseInt(e.values.flex_start_time)+parseInt(e.values.flexi_duration_allowed))}, then mark`,children:s.jsx(S,{options:k,optionLabel:"name",optionValue:"id",value:e.values.status_punch_in_time_exceeded,onChange:i=>e.setFieldValue("status_punch_in_time_exceeded",i.value)})}),s.jsx(t,{title:"Recurring",children:s.jsx(f,{name:"enable_flex_recurring",checked:e.values.enable_flex_recurring,onChange:i=>e.setFieldValue("enable_flex_recurring",i.value)})})]})]})]})})},Ce=({visible:n,onHide:w})=>{const u=W(D),V=[{label:"Add",onClick:()=>alert("Added"),className:"min-w-[90px]"}];return J({initialValues:{firstName:"",lastName:"",email:""},onSubmit:g=>{alert(JSON.stringify(g,null,2))}}),s.jsx(Q,{header:`${u?"Update":"Add"} Roster`,visible:n,onHide:w,actions:V,children:s.jsxs("div",{className:"m-auto grid w-full grid-cols-1 gap-3 md:grid-cols-2",children:[s.jsx(t,{required:!0,title:"Roster Name",children:s.jsx(p,{})}),s.jsx(t,{required:!0,title:"Description",children:s.jsx(p,{})}),s.jsx(t,{className:"col-span-2 gap-3",required:!0,title:"Weekly",children:s.jsxs("div",{className:"flex w-full flex-col",children:[s.jsx(t,{inlineStart:!0,title:"Monday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Tuesday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Wednesday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Thursday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Friday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Saturday",children:s.jsx(p,{className:""})}),s.jsx(t,{inlineStart:!0,title:"Sunday",children:s.jsx(p,{className:""})})]})})]})})},Pe=()=>{const n=c.useRef(),w=X(),[u,V]=c.useState(0),[g,_]=c.useState(""),[j,r]=c.useState(!1),[y,m]=c.useState(!1),[k,C]=c.useState(!1),N=[{id:1,label:"Attendance Policies",addButtonHeading:"Add Attendance Policy"},{id:2,label:"Biometric Devices",visible:!1,addButtonHeading:"Add Biometric Policy"},{id:3,label:"Shift",addButtonHeading:"Add Shift Policy"},{id:4,label:"Location",visible:!1,addButtonHeading:"Add Location Policy"},{id:5,label:"Rosters",visible:!1,addButtonHeading:"Add Roster Policy"}],q=async l=>await ve({filterBy:"search_term",filterValue:g,page:l.page+1,records:l.rows,sortBy:l.sortField?l.sortField:"",sortOrder:l.sortField?l.sortOrder===-1?"DESC":"ASC":""}),L=async l=>await be({filterBy:"search_term",filterValue:g,page:l.page+1,records:l.rows,sortBy:l.sortField?l.sortField:"",sortOrder:l.sortField?l.sortOrder===-1?"DESC":"ASC":""}),T=async l=>await we({page:l.page+1,records:l.rows,sortBy:l.sortField?l.sortField:"",sortOrder:l.sortField?l.sortOrder===-1?"DESC":"ASC":""}),E=l=>s.jsxs("div",{className:"flex w-full items-center justify-center gap-3",children:[s.jsx("img",{className:"cursor-pointer",width:25,height:25,src:ie,onClick:()=>a(l)}),s.jsx("img",{className:"cursor-pointer",width:25,height:25,src:le,onClick:()=>h(l)})]}),e=[{field:"name",header:"Attendance Policy Name",sortable:!0},{field:"description",header:"Description"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:E}],H=[{field:"shift_name",header:"Shift Policy Name",sortable:!0},{field:"shift_description",header:"Description"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:E}],R=[{field:"policy_name",header:"Attendance Policy Name",sortable:!0,body:l=>l.name},{field:"description",header:"Description"},{field:"actions",align:"center",alignHeader:"center",className:"cursor-default",header:"Actions",body:E}],O=()=>{if(u===0)return q;if(u===2)return L;if(u===4)return T},M=()=>{if(u===0)return e;if(u===2)return H;if(u===4)return R},a=l=>{u===0&&(w(Y(l.id)),r(!0)),u===2&&(w(Z(l.id)),m(!0)),u===4&&(w(ee(l.id)),C(!0))},h=l=>{const G=async I=>{let F;u===0?F=await je(I):u===2?F=await ye(I):u===4&&(F=await ke(I)),F.status===200&&(K.success(F.message),n.current.refreshListData())};return re({draggable:!1,resizable:!1,message:"Do you want to delete this policy?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClassName:"p-button-danger",accept:()=>G(l.id),reject:()=>{}})},B=()=>{u===0?r(!0):u===2?m(!0):C(!0)};return s.jsxs("div",{className:"flex w-full flex-col",children:[s.jsx("div",{className:"text-bold flex w-full px-2 pb-4 text-xl text-gray-600",children:"Attendance"}),s.jsxs(se,{className:"flex w-full flex-col",children:[s.jsx(oe,{activeIndex:u,onTabChange:l=>{_(""),V(l.index),n.current.loadFirstPage()},model:N}),s.jsxs("div",{className:"my-2 flex flex-col-reverse justify-between gap-3 p-3 md:flex-row",children:[s.jsxs("div",{className:"flex flex-col items-center gap-3 md:flex-row",children:[s.jsx(p,{placeholder:"Search policy name",value:g,onChange:l=>_(l.target.value)}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(U,{icon:"pi pi-times",severity:"danger",onClick:()=>{_(""),n.current&&n.current.refreshListData()}}),s.jsx(U,{icon:"pi pi-search",disabled:!g,onClick:()=>{n.current&&n.current.refreshListData()}})]})]}),s.jsx(U,{raised:!0,label:N.filter(l=>l.id===u+1)[0].addButtonHeading,icon:s.jsx("img",{src:te}),onClick:B})]}),s.jsx(ae,{ref:n,dataHandler:O(),id:"attendance_policies_module",headers:M()}),s.jsx(Fe,{visible:j,onHide:()=>r(!1),tableRef:n}),s.jsx(Ve,{visible:y,onHide:()=>m(!1),tableRef:n}),s.jsx(Ce,{visible:k,onHide:()=>C(!1),tableRef:n})]})]})};export{Pe as default};
